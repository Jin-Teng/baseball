{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "import requests\n",
    "from bs4 import BeautifulSoup\n",
    "import pandas as pd\n",
    "import numpy as np    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def homerun():\n",
    "    x = input(\"請輸入網址\")\n",
    "    x_1 = str(x)\n",
    "    res = requests.get(x_1)\n",
    "    soup = BeautifulSoup(res.text, \"lxml\")\n",
    "\n",
    "    data = []\n",
    "    data0 = []\n",
    "    table = soup.find('table', attrs={'class':'stats_table'})\n",
    "    table_body = table.find('tbody')\n",
    "    k=[\"Age\",\"Tm\",\"Lg\",\"G\",\"PA\",\"AB\",\"R\",\"H\",\"2B\",\"3B\",\"HR\",\"RBI\",\"SB\",\"CS\",\"BB\",\"SO\",\"BA\",\"OBP\",\"SLG\",\"OPS\",\"OPS+\",\"TB\",\"GDP\",\"HBP\",\"SH\",\"SF\",\"IBB\",\"Pos\",\"Awards\"]\n",
    "\n",
    "    rows = table_body.find_all('tr')\n",
    "    for row in rows:\n",
    "        cols = row.find_all('td')\n",
    "        cols0 = row.find_all(\"th\")\n",
    "        cols = [ele.text.strip() for ele in cols]\n",
    "        data.append([ele for ele in cols if ele]) # Get rid of empty values\n",
    "        cols0 = [ele0.text.strip() for ele0 in cols0]\n",
    "        data0.append([ele0 for ele0 in cols0 if ele0]) # Get rid of empty values\n",
    "    \n",
    "    frame = pd.DataFrame(data,columns=k)\n",
    "    frame0 = pd.DataFrame(data0,columns=[\"year\"])\n",
    "\n",
    "    frame_all_1 = pd.concat([frame0, frame], axis=1)\n",
    "    print(frame_all_1)\n",
    "    return frame_all_1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def clean(x): \n",
    "    frame_all_X = x\n",
    "    frame_all_X = frame_all_X.drop([\"year\", \"Tm\", \"Lg\", \"CS\", \"GDP\", \"HBP\", \"SH\", \"SF\", \"IBB\", \"Pos\", \"Awards\",\"BA\",\"OBP\",\"SLG\", \"OPS\"], axis=1)\n",
    "    frame_all_X[\"Age\"] = frame_all_X[\"Age\"].astype(\"float\")\n",
    "    frame_all_X[\"G\"] = frame_all_X[\"G\"].astype(\"float\")\n",
    "    frame_all_X[\"PA\"] = frame_all_X[\"PA\"].astype(\"float\")\n",
    "    frame_all_X[\"AB\"] = frame_all_X[\"AB\"].astype(\"float\")\n",
    "    frame_all_X[\"R\"] = frame_all_X[\"R\"].astype(\"float\")\n",
    "    frame_all_X[\"H\"] = frame_all_X[\"H\"].astype(\"float\")\n",
    "    frame_all_X[\"3B\"] = frame_all_X[\"3B\"].astype(\"float\")\n",
    "    frame_all_X[\"2B\"] = frame_all_X[\"2B\"].astype(\"float\")\n",
    "    frame_all_X[\"RBI\"] = frame_all_X[\"RBI\"].astype(\"float\")\n",
    "    frame_all_X[\"SB\"] = frame_all_X[\"SB\"].astype(\"float\")\n",
    "    frame_all_X[\"BB\"] = frame_all_X[\"BB\"].astype(\"float\")\n",
    "    frame_all_X[\"SO\"] = frame_all_X[\"SO\"].astype(\"float\")\n",
    "    frame_all_X[\"TB\"] = frame_all_X[\"TB\"].astype(\"float\")\n",
    "    frame_all_X[\"OPS+\"] = frame_all_X[\"OPS+\"].astype(\"float\")\n",
    "    frame_all_X[\"HR\"] = frame_all_X[\"HR\"].astype(\"float\")#總共15個比較項目\n",
    "    return frame_all_X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "def output_y(frame_all_X):    \n",
    "    frame_all_Y = frame_all_X[\"HR\"]#輸出\n",
    "    frame_all_Y = frame_all_Y.astype(\"float\")\n",
    "    return frame_all_Y"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/c/crawfca02.shtml\n",
      "    year Age       Tm         Lg    G   PA   AB    R    H  2B       ...        \\\n",
      "0   1999  17  TBD-min         Rk   60  278  260   62   83  14       ...         \n",
      "1   2000  18  TBD-min          A  135  609  564   99  170  21       ...         \n",
      "2   2001  19  TBD-min         AA  132  585  537   64  147  24       ...         \n",
      "3   2002  20  TBD-min        AAA   85  383  353   59  105  17       ...         \n",
      "4   2002  20      TBD         AL   63  278  259   23   67  11       ...         \n",
      "5   2003  21      TBD         AL  151  661  630   80  177  18       ...         \n",
      "6   2004  22      TBD         AL  152  672  626  104  185  26       ...         \n",
      "7   2005  23      TBD         AL  156  687  644  101  194  33       ...         \n",
      "8   2006  24      TBD         AL  151  653  600   89  183  20       ...         \n",
      "9   2007  25      TBD         AL  143  627  584   93  184  37       ...         \n",
      "10  2008  26      TBR         AL  109  482  443   69  121  12       ...         \n",
      "11  2009  27      TBR         AL  156  672  606   96  185  28       ...         \n",
      "12  2010  28      TBR         AL  154  663  600  110  184  30       ...         \n",
      "13  2011  29  BOS-min        AAA    2    6    5    1    1   0       ...         \n",
      "14  2011  29      BOS         AL  130  539  506   65  129  29       ...         \n",
      "15  2012  30  BOS-min  Rk,AAA,AA   11   44   36    6   11   1       ...         \n",
      "16  2012  30      BOS         AL   31  125  117   23   33  10       ...         \n",
      "17  2013  31  LAD-min         A+    4   14   13    2    5   1       ...         \n",
      "18  2013  31      LAD         NL  116  469  435   62  123  30       ...         \n",
      "19  2014  32  LAD-min        AAA    4   11   11    4    5   0       ...         \n",
      "20  2014  32      LAD         NL  105  370  343   56  103  14       ...         \n",
      "21  2015  33  LAD-min     AAA,A+   10   38   34    9   12   2       ...         \n",
      "22  2015  33      LAD         NL   69  193  181   19   48   9       ...         \n",
      "23  2016  34  LAD-min     AAA,A+    3   12   11    1    4   2       ...         \n",
      "24  2016  34      LAD         NL   30   87   81    8   15   2       ...         \n",
      "\n",
      "      OPS OPS+   TB GDP HBP SH SF                       IBB    Pos  \\\n",
      "0    .754  105    5   1   1  3  0                PRI · APPY   None   \n",
      "1    .751  231    1   3   9  1  1                CHS · SALL   None   \n",
      "2    .675  189    3   4   6  2  2                ORL · SOUL   None   \n",
      "3    .791  161    5   2   4  4  5                  DHM · IL   None   \n",
      "4    .661   77   96   0   3  6  1                         0      7   \n",
      "5    .671   81  228   5   1  1  3                         4  *78/D   \n",
      "6    .781  105  282   2   1  4  6                         2  *78/D   \n",
      "7    .800  112  302  11   5  5  6                         1  *7/8D   \n",
      "8    .830  113  289   8   4  9  2                         3  *7/D8   \n",
      "9    .820  117  272  11   5  1  2                         5   *7/D   \n",
      "10   .718   89  177  10   2  0  5                         1   7/8D   \n",
      "11   .816  116  274   7   8  2  5                         1   *7/D   \n",
      "12   .851  135  297   2   3  3  5                         3   *7/D   \n",
      "13   .533    1    0   0   0  0  0                  PAW · IL   None   \n",
      "14   .694   85  205   7   3  2  4                         1   *7/D   \n",
      "15   .821   14    1   0   0  0  1  RES,PAW,PRT · GULF,IL,EL   None   \n",
      "16   .785  108   56   1   2  1  2                         0    7/D   \n",
      "17   .890    6    0   0   0  0  0                RCU · CALL   None   \n",
      "18   .736  107  177   4   3  0  2                         2    7/D   \n",
      "19  1.273    9    0   0   0  0  0                 ABQ · PCL   None   \n",
      "20   .767  118  147   5   6  0  4                         0      7   \n",
      "21  1.012   21    1   1   0  1  0        OKC,RCU · PCL,CALL   None   \n",
      "22   .707   96   73   3   0  0  0                         1    7/D   \n",
      "23   .962    6    0   0   0  0  0        OKC,RCU · PCL,CALL   None   \n",
      "24   .464   27   19   3   1  0  1                         0    7/D   \n",
      "\n",
      "            Awards  \n",
      "0             None  \n",
      "1             None  \n",
      "2             None  \n",
      "3             None  \n",
      "4             None  \n",
      "5             None  \n",
      "6               AS  \n",
      "7             None  \n",
      "8           MVP-26  \n",
      "9               AS  \n",
      "10            None  \n",
      "11              AS  \n",
      "12  AS,MVP-7,GG,SS  \n",
      "13            None  \n",
      "14            None  \n",
      "15            None  \n",
      "16            None  \n",
      "17            None  \n",
      "18            None  \n",
      "19            None  \n",
      "20            None  \n",
      "21            None  \n",
      "22            None  \n",
      "23            None  \n",
      "24            None  \n",
      "\n",
      "[25 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_2 = homerun()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "#4 5 6 7 8 9 10 11 12 14 16 18 20 22 24"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>Age</th>\n",
       "      <th>Tm</th>\n",
       "      <th>Lg</th>\n",
       "      <th>G</th>\n",
       "      <th>PA</th>\n",
       "      <th>AB</th>\n",
       "      <th>R</th>\n",
       "      <th>H</th>\n",
       "      <th>2B</th>\n",
       "      <th>...</th>\n",
       "      <th>OPS</th>\n",
       "      <th>OPS+</th>\n",
       "      <th>TB</th>\n",
       "      <th>GDP</th>\n",
       "      <th>HBP</th>\n",
       "      <th>SH</th>\n",
       "      <th>SF</th>\n",
       "      <th>IBB</th>\n",
       "      <th>Pos</th>\n",
       "      <th>Awards</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2002</td>\n",
       "      <td>20</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>63</td>\n",
       "      <td>278</td>\n",
       "      <td>259</td>\n",
       "      <td>23</td>\n",
       "      <td>67</td>\n",
       "      <td>11</td>\n",
       "      <td>...</td>\n",
       "      <td>.661</td>\n",
       "      <td>77</td>\n",
       "      <td>96</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>2003</td>\n",
       "      <td>21</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>151</td>\n",
       "      <td>661</td>\n",
       "      <td>630</td>\n",
       "      <td>80</td>\n",
       "      <td>177</td>\n",
       "      <td>18</td>\n",
       "      <td>...</td>\n",
       "      <td>.671</td>\n",
       "      <td>81</td>\n",
       "      <td>228</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>*78/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2004</td>\n",
       "      <td>22</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>152</td>\n",
       "      <td>672</td>\n",
       "      <td>626</td>\n",
       "      <td>104</td>\n",
       "      <td>185</td>\n",
       "      <td>26</td>\n",
       "      <td>...</td>\n",
       "      <td>.781</td>\n",
       "      <td>105</td>\n",
       "      <td>282</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>*78/D</td>\n",
       "      <td>AS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>2005</td>\n",
       "      <td>23</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>156</td>\n",
       "      <td>687</td>\n",
       "      <td>644</td>\n",
       "      <td>101</td>\n",
       "      <td>194</td>\n",
       "      <td>33</td>\n",
       "      <td>...</td>\n",
       "      <td>.800</td>\n",
       "      <td>112</td>\n",
       "      <td>302</td>\n",
       "      <td>11</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>*7/8D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>2006</td>\n",
       "      <td>24</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>151</td>\n",
       "      <td>653</td>\n",
       "      <td>600</td>\n",
       "      <td>89</td>\n",
       "      <td>183</td>\n",
       "      <td>20</td>\n",
       "      <td>...</td>\n",
       "      <td>.830</td>\n",
       "      <td>113</td>\n",
       "      <td>289</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>*7/D8</td>\n",
       "      <td>MVP-26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2007</td>\n",
       "      <td>25</td>\n",
       "      <td>TBD</td>\n",
       "      <td>AL</td>\n",
       "      <td>143</td>\n",
       "      <td>627</td>\n",
       "      <td>584</td>\n",
       "      <td>93</td>\n",
       "      <td>184</td>\n",
       "      <td>37</td>\n",
       "      <td>...</td>\n",
       "      <td>.820</td>\n",
       "      <td>117</td>\n",
       "      <td>272</td>\n",
       "      <td>11</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>*7/D</td>\n",
       "      <td>AS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2008</td>\n",
       "      <td>26</td>\n",
       "      <td>TBR</td>\n",
       "      <td>AL</td>\n",
       "      <td>109</td>\n",
       "      <td>482</td>\n",
       "      <td>443</td>\n",
       "      <td>69</td>\n",
       "      <td>121</td>\n",
       "      <td>12</td>\n",
       "      <td>...</td>\n",
       "      <td>.718</td>\n",
       "      <td>89</td>\n",
       "      <td>177</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>7/8D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>2009</td>\n",
       "      <td>27</td>\n",
       "      <td>TBR</td>\n",
       "      <td>AL</td>\n",
       "      <td>156</td>\n",
       "      <td>672</td>\n",
       "      <td>606</td>\n",
       "      <td>96</td>\n",
       "      <td>185</td>\n",
       "      <td>28</td>\n",
       "      <td>...</td>\n",
       "      <td>.816</td>\n",
       "      <td>116</td>\n",
       "      <td>274</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>*7/D</td>\n",
       "      <td>AS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>2010</td>\n",
       "      <td>28</td>\n",
       "      <td>TBR</td>\n",
       "      <td>AL</td>\n",
       "      <td>154</td>\n",
       "      <td>663</td>\n",
       "      <td>600</td>\n",
       "      <td>110</td>\n",
       "      <td>184</td>\n",
       "      <td>30</td>\n",
       "      <td>...</td>\n",
       "      <td>.851</td>\n",
       "      <td>135</td>\n",
       "      <td>297</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>*7/D</td>\n",
       "      <td>AS,MVP-7,GG,SS</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2011</td>\n",
       "      <td>29</td>\n",
       "      <td>BOS</td>\n",
       "      <td>AL</td>\n",
       "      <td>130</td>\n",
       "      <td>539</td>\n",
       "      <td>506</td>\n",
       "      <td>65</td>\n",
       "      <td>129</td>\n",
       "      <td>29</td>\n",
       "      <td>...</td>\n",
       "      <td>.694</td>\n",
       "      <td>85</td>\n",
       "      <td>205</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>*7/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2012</td>\n",
       "      <td>30</td>\n",
       "      <td>BOS</td>\n",
       "      <td>AL</td>\n",
       "      <td>31</td>\n",
       "      <td>125</td>\n",
       "      <td>117</td>\n",
       "      <td>23</td>\n",
       "      <td>33</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>.785</td>\n",
       "      <td>108</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>7/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2013</td>\n",
       "      <td>31</td>\n",
       "      <td>LAD</td>\n",
       "      <td>NL</td>\n",
       "      <td>116</td>\n",
       "      <td>469</td>\n",
       "      <td>435</td>\n",
       "      <td>62</td>\n",
       "      <td>123</td>\n",
       "      <td>30</td>\n",
       "      <td>...</td>\n",
       "      <td>.736</td>\n",
       "      <td>107</td>\n",
       "      <td>177</td>\n",
       "      <td>4</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>7/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>2014</td>\n",
       "      <td>32</td>\n",
       "      <td>LAD</td>\n",
       "      <td>NL</td>\n",
       "      <td>105</td>\n",
       "      <td>370</td>\n",
       "      <td>343</td>\n",
       "      <td>56</td>\n",
       "      <td>103</td>\n",
       "      <td>14</td>\n",
       "      <td>...</td>\n",
       "      <td>.767</td>\n",
       "      <td>118</td>\n",
       "      <td>147</td>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2015</td>\n",
       "      <td>33</td>\n",
       "      <td>LAD</td>\n",
       "      <td>NL</td>\n",
       "      <td>69</td>\n",
       "      <td>193</td>\n",
       "      <td>181</td>\n",
       "      <td>19</td>\n",
       "      <td>48</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>.707</td>\n",
       "      <td>96</td>\n",
       "      <td>73</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>7/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>2016</td>\n",
       "      <td>34</td>\n",
       "      <td>LAD</td>\n",
       "      <td>NL</td>\n",
       "      <td>30</td>\n",
       "      <td>87</td>\n",
       "      <td>81</td>\n",
       "      <td>8</td>\n",
       "      <td>15</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>.464</td>\n",
       "      <td>27</td>\n",
       "      <td>19</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>7/D</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>15 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    year Age   Tm  Lg    G   PA   AB    R    H  2B       ...         OPS OPS+  \\\n",
       "4   2002  20  TBD  AL   63  278  259   23   67  11       ...        .661   77   \n",
       "5   2003  21  TBD  AL  151  661  630   80  177  18       ...        .671   81   \n",
       "6   2004  22  TBD  AL  152  672  626  104  185  26       ...        .781  105   \n",
       "7   2005  23  TBD  AL  156  687  644  101  194  33       ...        .800  112   \n",
       "8   2006  24  TBD  AL  151  653  600   89  183  20       ...        .830  113   \n",
       "9   2007  25  TBD  AL  143  627  584   93  184  37       ...        .820  117   \n",
       "10  2008  26  TBR  AL  109  482  443   69  121  12       ...        .718   89   \n",
       "11  2009  27  TBR  AL  156  672  606   96  185  28       ...        .816  116   \n",
       "12  2010  28  TBR  AL  154  663  600  110  184  30       ...        .851  135   \n",
       "14  2011  29  BOS  AL  130  539  506   65  129  29       ...        .694   85   \n",
       "16  2012  30  BOS  AL   31  125  117   23   33  10       ...        .785  108   \n",
       "18  2013  31  LAD  NL  116  469  435   62  123  30       ...        .736  107   \n",
       "20  2014  32  LAD  NL  105  370  343   56  103  14       ...        .767  118   \n",
       "22  2015  33  LAD  NL   69  193  181   19   48   9       ...        .707   96   \n",
       "24  2016  34  LAD  NL   30   87   81    8   15   2       ...        .464   27   \n",
       "\n",
       "     TB GDP HBP SH SF IBB    Pos          Awards  \n",
       "4    96   0   3  6  1   0      7            None  \n",
       "5   228   5   1  1  3   4  *78/D            None  \n",
       "6   282   2   1  4  6   2  *78/D              AS  \n",
       "7   302  11   5  5  6   1  *7/8D            None  \n",
       "8   289   8   4  9  2   3  *7/D8          MVP-26  \n",
       "9   272  11   5  1  2   5   *7/D              AS  \n",
       "10  177  10   2  0  5   1   7/8D            None  \n",
       "11  274   7   8  2  5   1   *7/D              AS  \n",
       "12  297   2   3  3  5   3   *7/D  AS,MVP-7,GG,SS  \n",
       "14  205   7   3  2  4   1   *7/D            None  \n",
       "16   56   1   2  1  2   0    7/D            None  \n",
       "18  177   4   3  0  2   2    7/D            None  \n",
       "20  147   5   6  0  4   0      7            None  \n",
       "22   73   3   0  0  0   1    7/D            None  \n",
       "24   19   3   1  0  1   0    7/D            None  \n",
       "\n",
       "[15 rows x 30 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#1.drop raw\n",
    "Data_2 = Data_2.drop([0,1,2,3,13,15,17,19,21,23], axis=0)\n",
    "Data_2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Age</th>\n",
       "      <th>G</th>\n",
       "      <th>PA</th>\n",
       "      <th>AB</th>\n",
       "      <th>R</th>\n",
       "      <th>H</th>\n",
       "      <th>2B</th>\n",
       "      <th>3B</th>\n",
       "      <th>HR</th>\n",
       "      <th>RBI</th>\n",
       "      <th>SB</th>\n",
       "      <th>BB</th>\n",
       "      <th>SO</th>\n",
       "      <th>OPS+</th>\n",
       "      <th>TB</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>20.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>278.0</td>\n",
       "      <td>259.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>41.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>96.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>21.0</td>\n",
       "      <td>151.0</td>\n",
       "      <td>661.0</td>\n",
       "      <td>630.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>177.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>54.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>102.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>228.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>22.0</td>\n",
       "      <td>152.0</td>\n",
       "      <td>672.0</td>\n",
       "      <td>626.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>282.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>23.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>687.0</td>\n",
       "      <td>644.0</td>\n",
       "      <td>101.0</td>\n",
       "      <td>194.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>84.0</td>\n",
       "      <td>112.0</td>\n",
       "      <td>302.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>24.0</td>\n",
       "      <td>151.0</td>\n",
       "      <td>653.0</td>\n",
       "      <td>600.0</td>\n",
       "      <td>89.0</td>\n",
       "      <td>183.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>113.0</td>\n",
       "      <td>289.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>25.0</td>\n",
       "      <td>143.0</td>\n",
       "      <td>627.0</td>\n",
       "      <td>584.0</td>\n",
       "      <td>93.0</td>\n",
       "      <td>184.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>112.0</td>\n",
       "      <td>117.0</td>\n",
       "      <td>272.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>26.0</td>\n",
       "      <td>109.0</td>\n",
       "      <td>482.0</td>\n",
       "      <td>443.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>121.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>57.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>89.0</td>\n",
       "      <td>177.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>27.0</td>\n",
       "      <td>156.0</td>\n",
       "      <td>672.0</td>\n",
       "      <td>606.0</td>\n",
       "      <td>96.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>99.0</td>\n",
       "      <td>116.0</td>\n",
       "      <td>274.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>28.0</td>\n",
       "      <td>154.0</td>\n",
       "      <td>663.0</td>\n",
       "      <td>600.0</td>\n",
       "      <td>110.0</td>\n",
       "      <td>184.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>135.0</td>\n",
       "      <td>297.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>29.0</td>\n",
       "      <td>130.0</td>\n",
       "      <td>539.0</td>\n",
       "      <td>506.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>129.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>56.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>104.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>205.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>30.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>125.0</td>\n",
       "      <td>117.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>33.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>108.0</td>\n",
       "      <td>56.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>31.0</td>\n",
       "      <td>116.0</td>\n",
       "      <td>469.0</td>\n",
       "      <td>435.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>123.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>107.0</td>\n",
       "      <td>177.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>32.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>370.0</td>\n",
       "      <td>343.0</td>\n",
       "      <td>56.0</td>\n",
       "      <td>103.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>118.0</td>\n",
       "      <td>147.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>33.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>193.0</td>\n",
       "      <td>181.0</td>\n",
       "      <td>19.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>41.0</td>\n",
       "      <td>96.0</td>\n",
       "      <td>73.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>34.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>87.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>19.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     Age      G     PA     AB      R      H    2B    3B    HR   RBI    SB  \\\n",
       "4   20.0   63.0  278.0  259.0   23.0   67.0  11.0   6.0   2.0  30.0   9.0   \n",
       "5   21.0  151.0  661.0  630.0   80.0  177.0  18.0   9.0   5.0  54.0  55.0   \n",
       "6   22.0  152.0  672.0  626.0  104.0  185.0  26.0  19.0  11.0  55.0  59.0   \n",
       "7   23.0  156.0  687.0  644.0  101.0  194.0  33.0  15.0  15.0  81.0  46.0   \n",
       "8   24.0  151.0  653.0  600.0   89.0  183.0  20.0  16.0  18.0  77.0  58.0   \n",
       "9   25.0  143.0  627.0  584.0   93.0  184.0  37.0   9.0  11.0  80.0  50.0   \n",
       "10  26.0  109.0  482.0  443.0   69.0  121.0  12.0  10.0   8.0  57.0  25.0   \n",
       "11  27.0  156.0  672.0  606.0   96.0  185.0  28.0   8.0  15.0  68.0  60.0   \n",
       "12  28.0  154.0  663.0  600.0  110.0  184.0  30.0  13.0  19.0  90.0  47.0   \n",
       "14  29.0  130.0  539.0  506.0   65.0  129.0  29.0   7.0  11.0  56.0  18.0   \n",
       "16  30.0   31.0  125.0  117.0   23.0   33.0  10.0   2.0   3.0  19.0   5.0   \n",
       "18  31.0  116.0  469.0  435.0   62.0  123.0  30.0   3.0   6.0  31.0  15.0   \n",
       "20  32.0  105.0  370.0  343.0   56.0  103.0  14.0   3.0   8.0  46.0  23.0   \n",
       "22  33.0   69.0  193.0  181.0   19.0   48.0   9.0   2.0   4.0  16.0  10.0   \n",
       "24  34.0   30.0   87.0   81.0    8.0   15.0   2.0   1.0   0.0   6.0   0.0   \n",
       "\n",
       "      BB     SO   OPS+     TB  \n",
       "4    9.0   41.0   77.0   96.0  \n",
       "5   26.0  102.0   81.0  228.0  \n",
       "6   35.0   81.0  105.0  282.0  \n",
       "7   27.0   84.0  112.0  302.0  \n",
       "8   37.0   85.0  113.0  289.0  \n",
       "9   32.0  112.0  117.0  272.0  \n",
       "10  30.0   60.0   89.0  177.0  \n",
       "11  51.0   99.0  116.0  274.0  \n",
       "12  46.0  104.0  135.0  297.0  \n",
       "14  23.0  104.0   85.0  205.0  \n",
       "16   3.0   22.0  108.0   56.0  \n",
       "18  28.0   66.0  107.0  177.0  \n",
       "20  16.0   55.0  118.0  147.0  \n",
       "22  10.0   41.0   96.0   73.0  \n",
       "24   4.0   11.0   27.0   19.0  "
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#2.用clean函數把MLB的資料抓出來\n",
    "X_2_origin = clean(Data_2) #floot\n",
    "X_2_origin"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4      2.0\n",
       "5      5.0\n",
       "6     11.0\n",
       "7     15.0\n",
       "8     18.0\n",
       "9     11.0\n",
       "10     8.0\n",
       "11    15.0\n",
       "12    19.0\n",
       "14    11.0\n",
       "16     3.0\n",
       "18     6.0\n",
       "20     8.0\n",
       "22     4.0\n",
       "24     0.0\n",
       "Name: HR, dtype: float64"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#3.做y\n",
    "Y_2_origin = output_y(X_2_origin)\n",
    "Y_2_origin"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "#4.把訓練跟測試資料分好\n",
    "X_2_finish = X_2_origin.values\n",
    "num = Y_2_origin.count()\n",
    "x_2_train = X_2_finish[:10]#最後一個不要[0:10]\n",
    "x_2_test = X_2_finish[10:num-1]#[10:num-1]\n",
    "Y_2_finish = Y_2_origin.values\n",
    "y_2_train = Y_2_finish[1:11]#[1:11]\n",
    "y_2_test = Y_2_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(x_2_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/c/castivi02.shtml\n",
      "    year                                              Age       Tm       Lg  \\\n",
      "0   1987                                               19      SLT      AAA   \n",
      "1   1987  Did not play in major or minor leagues (Mexico)     None     None   \n",
      "2   1988                                               20  SLT,MVA      AAA   \n",
      "3   1988  Did not play in major or minor leagues (Mexico)     None     None   \n",
      "4   1989                                               21      SLT      AAA   \n",
      "5   1989  Did not play in major or minor leagues (Mexico)     None     None   \n",
      "6   1990                                               22  ATL-min     A,AA   \n",
      "7   1991                                               23  ATL-min   AA,AAA   \n",
      "8   1991                                               23      ATL       NL   \n",
      "9   1992                                               24  ATL-min      AAA   \n",
      "10  1992                                               24      ATL       NL   \n",
      "11  1993                                               25      COL       NL   \n",
      "12  1994                                               26  COL-min      AAA   \n",
      "13  1994                                               26      COL       NL   \n",
      "14  1995                                               27      COL       NL   \n",
      "15  1996                                               28      COL       NL   \n",
      "16  1997                                               29      COL       NL   \n",
      "17  1998                                               30      COL       NL   \n",
      "18  1999                                               31      COL       NL   \n",
      "19  2000                                               32  TBD-min      AAA   \n",
      "20  2000                                               32      TBD       AL   \n",
      "21  2001                                               33      TOT      MLB   \n",
      "22  2001                                               33      TBD       AL   \n",
      "23  2001                                               33      HOU       NL   \n",
      "24  2002                                               34      ATL       NL   \n",
      "25  2003                                               35      ATL       NL   \n",
      "26  2004                                               36      COL       NL   \n",
      "27  2005                                               37      WSN       NL   \n",
      "28  2006                                               38  COL-min  AAA,FgW   \n",
      "29  2006                                               38      TOT       NL   \n",
      "30  2006                                               38      SDP       NL   \n",
      "31  2006                                               38      COL       NL   \n",
      "32  2007                                               39      HRM      FgW   \n",
      "33  2008                                               40      HRM      FgW   \n",
      "34  2009                                               41      HRM      FgW   \n",
      "35  2010                                               42      HRM      FgW   \n",
      "\n",
      "                G    PA    AB     R     H    2B      ...         OPS  OPS+  \\\n",
      "0       SLT · MEX  None  None  None  None  None      ...        None  None   \n",
      "1            None  None  None  None  None  None      ...        None  None   \n",
      "2   SLT,MVA · MEX  None  None  None  None  None      ...        None  None   \n",
      "3            None  None  None  None  None  None      ...        None  None   \n",
      "4       SLT · MEX  None  None  None  None  None      ...        None  None   \n",
      "5            None  None  None  None  None  None      ...        None  None   \n",
      "6             139   567   509    67   131    20      ...        .707   196   \n",
      "7             133   538   499    59   124    24      ...        .692   204   \n",
      "8              12     6     5     1     1     0      ...        .400    11   \n",
      "9             127   483   449    49   113    29      ...        .655   165   \n",
      "10              9    18    16     1     4     1      ...        .646    79   \n",
      "11            105   357   337    36    86     9      ...        .686    71   \n",
      "12             22    90    78    13    19     6      ...        .688    30   \n",
      "13             52   141   130    16    43    11      ...        .857   107   \n",
      "14            139   571   527    82   163    34      ...        .911   113   \n",
      "15            160   673   629    97   191    34      ...        .892   112   \n",
      "16            159   668   612    94   186    25      ...        .904   115   \n",
      "17            162   697   645   108   206    28      ...        .951   127   \n",
      "18            158   674   615    83   169    24      ...        .809    84   \n",
      "19              2     8     8     1     3     1      ...       1.250     7   \n",
      "20             85   354   331    22    73     9      ...        .562    43   \n",
      "21            146   581   538    69   140    34      ...        .775    94   \n",
      "22             24    97    93     7    20     6      ...        .592    56   \n",
      "23            122   484   445    62   120    28      ...        .812   101   \n",
      "24            143   578   543    56   126    23      ...        .616    60   \n",
      "25            147   578   542    65   150    28      ...        .771    97   \n",
      "26            148   648   583    93   158    43      ...        .867   109   \n",
      "27            142   549   494    53   125    36      ...        .722    93   \n",
      "28             17    70    61    11    18     4      ...        .796    25   \n",
      "29             87   291   275    26    63    10      ...        .578    53   \n",
      "30             72   269   254    24    59    10      ...        .579    54   \n",
      "31             15    22    21     2     4     0      ...        .561    37   \n",
      "32             18    74    63     9    22     3      ...       1.040    40   \n",
      "33              7    31    28     4     6     1      ...        .755    13   \n",
      "34             30   134   113    16    33     7      ...        .935    61   \n",
      "35              3    12    12     0     1     0      ...        .167     1   \n",
      "\n",
      "      TB   GDP   HBP    SH                   SF                 IBB    Pos  \\\n",
      "0   None  None  None  None                 None                None   None   \n",
      "1   None  None  None  None                 None                None   None   \n",
      "2   None  None  None  None                 None                None   None   \n",
      "3   None  None  None  None                 None                None   None   \n",
      "4   None  None  None  None                 None                None   None   \n",
      "5   None  None  None  None                 None                None   None   \n",
      "6     10     1     6     4  SUM,GRV · SALL,SOUL                None   None   \n",
      "7      8     5     2     9                    3   GRV,RMD · SOUL,IL   None   \n",
      "8      1     0     0     1                    0                   0      6   \n",
      "9     19     4     3     6                    1            RMD · IL   None   \n",
      "10     5     0     1     0                    0                   1    /56   \n",
      "11   136    10     2     0                    5                   4      6   \n",
      "12     6     1     1     3                    0           CSP · PCL   None   \n",
      "13    65     3     0     1                    3                   1  64/53   \n",
      "14   297    15     4     4                    6                   2   *5/6   \n",
      "15   345    20     5     0                    4                   7     *5   \n",
      "16   335    17     8     0                    4                   9     *5   \n",
      "17   380    24     6     0                    6                   7   *5/6   \n",
      "18   294    15     1     0                    5                   7     *5   \n",
      "19     0     0     0     0                    0            DHM · IL   None   \n",
      "20   102     9     3     0                    6                   3      5   \n",
      "21   251    22     4     0                    4                   3   *5/6   \n",
      "22    32     3     1     0                    0                   0      5   \n",
      "23   219    19     3     0                    4                   3   *5/6   \n",
      "24   189    22     7     0                    6                   4     *5   \n",
      "25   250    22     3     1                    6                   3     *5   \n",
      "26   312    22     6     0                    8                   6     *5   \n",
      "27   199    16     7     1                    4                   7     *5   \n",
      "28     2     3     0     0                    0  CSP,HRM · PCL,MXPW   None   \n",
      "29    88     7     3     0                    4                   0    5/3   \n",
      "30    81     5     2     0                    4                   0      5   \n",
      "31     7     2     1     0                    0                   0    /35   \n",
      "32     3     1     0     3                    0          HRM · MXPW   None   \n",
      "33     2     0     0     0                    0          HRM · MXPW   None   \n",
      "34     6     4     0     1                    1          HRM · MXPW   None   \n",
      "35     0     0     0     0                    0          HRM · MXPW   None   \n",
      "\n",
      "          Awards  \n",
      "0           None  \n",
      "1           None  \n",
      "2           None  \n",
      "3           None  \n",
      "4           None  \n",
      "5           None  \n",
      "6           None  \n",
      "7           None  \n",
      "8           None  \n",
      "9           None  \n",
      "10          None  \n",
      "11          None  \n",
      "12          None  \n",
      "13          None  \n",
      "14  AS,MVP-18,SS  \n",
      "15          None  \n",
      "16     MVP-22,SS  \n",
      "17  AS,MVP-11,SS  \n",
      "18          None  \n",
      "19          None  \n",
      "20          None  \n",
      "21          None  \n",
      "22          None  \n",
      "23          None  \n",
      "24          None  \n",
      "25          None  \n",
      "26        MVP-23  \n",
      "27          None  \n",
      "28          None  \n",
      "29          None  \n",
      "30          None  \n",
      "31          None  \n",
      "32          None  \n",
      "33          None  \n",
      "34          None  \n",
      "35          None  \n",
      "\n",
      "[36 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_1 = homerun()#Vinny Castilla"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "#1,3,5,6,7,9,12,20,22,23,29,30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "#drop raw\n",
    "Data_1 = Data_1.drop([0,1,2,3,4,5,6,7,9,12,20,22,23,28,29,30], axis=0)\n",
    "X_1_origin = clean(Data_1) #floot\n",
    "Y_1_origin = output_y(X_1_origin)\n",
    "X_1_finish = X_1_origin.values\n",
    "num = Y_1_origin.count()\n",
    "x_1_train = X_1_finish[:10]#最後一個不要[0:10]\n",
    "x_1_test = X_1_finish[10:num-1]#[10:num-1]\n",
    "Y_1_finish = Y_1_origin.values\n",
    "y_1_train = Y_1_finish[1:11]#[1:11]\n",
    "y_1_test = Y_1_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/d/dunnad01.shtml\n",
      "    year Age       Tm      Lg    G   PA   AB    R    H  2B   ...      OPS  \\\n",
      "0   1998  18  CIN-min      Rk   34  151  125   26   36   3   ...     .828   \n",
      "1   1999  19  CIN-min       A   93  372  313   62   96  16   ...     .885   \n",
      "2   2000  20  CIN-min       A  122  538  420  101  118  29   ...     .897   \n",
      "3   2001  21  CIN-min  AAA,AA   94  422  350   74  117  22   ...    1.116   \n",
      "4   2001  21      CIN      NL   66  286  244   54   64  18   ...     .948   \n",
      "5   2002  22      CIN      NL  158  676  535   84  133  28   ...     .854   \n",
      "6   2003  23      CIN      NL  116  469  381   70   82  12   ...     .819   \n",
      "7   2004  24      CIN      NL  161  681  568  105  151  34   ...     .956   \n",
      "8   2005  25      CIN      NL  160  671  543  107  134  35   ...     .927   \n",
      "9   2006  26      CIN      NL  160  683  561   99  131  24   ...     .855   \n",
      "10  2007  27      CIN      NL  152  632  522  101  138  27   ...     .940   \n",
      "11  2008  28      TOT      NL  158  651  517   79  122  23   ...     .898   \n",
      "12  2008  28      CIN      NL  114  464  373   58   87  14   ...     .901   \n",
      "13  2008  28      ARI      NL   44  187  144   21   35   9   ...     .889   \n",
      "14  2009  29      WSN      NL  159  668  546   81  146  29   ...     .928   \n",
      "15  2010  30      WSN      NL  158  648  558   85  145  36   ...     .892   \n",
      "16  2011  31      CHW      AL  122  496  415   36   66  16   ...     .569   \n",
      "17  2012  32      CHW      AL  151  649  539   87  110  19   ...     .800   \n",
      "18  2013  33      CHW      AL  149  607  525   60  115  15   ...     .762   \n",
      "19  2014  34      TOT      AL  131  511  429   49   94  18   ...     .752   \n",
      "20  2014  34      CHW      AL  106  435  363   43   80  17   ...     .773   \n",
      "21  2014  34      OAK      AL   25   76   66    6   14   1   ...     .634   \n",
      "\n",
      "   OPS+   TB GDP HBP SH SF                IBB     Pos  Awards  \n",
      "0    53    3   3   0  1  1         BIL · PION    None    None  \n",
      "1   149    6  10   0  3  3         RFD · MIDW    None    None  \n",
      "2   197   10  12   0  6  4         DAY · MIDW    None    None  \n",
      "3   235    2   8   1  1  6  LOU,CNG · IL,SOUL    None    None  \n",
      "4   136  141   4   4  0  0                  2      97   RoY-4  \n",
      "5   121  243   8   9  1  3                 13  *739/D      AS  \n",
      "6   116  177   4  10  0  4                  8   73/9D    None  \n",
      "7   147  323   8   5  0  0                 11   *73/D  MVP-28  \n",
      "8   140  293   6  12  0  2                 14     *73  MVP-26  \n",
      "9   114  275   8   6  1  3                 12   *7/3D    None  \n",
      "10  136  289  12   5  0  4                  8    *7/D    None  \n",
      "11  131  265   7   7  0  5                 13  *793/D    None  \n",
      "12  132  197   4   6  0  5                  6    *7/D    None  \n",
      "13  127   68   3   1  0  0                  7    93/7    None  \n",
      "14  144  289   8   4  0  2                 16   379/D    None  \n",
      "15  138  299  10   9  0  4                 10    *3/D  MVP-21  \n",
      "16   54  115  10   4  0  2                  0    D3/9    None  \n",
      "17  114  252   8   1  0  4                  3    D3/7      AS  \n",
      "18  105  232   2   3  0  3                  7    D3/7    None  \n",
      "19  115  178   5   7  0  4                  5  D3/791    None  \n",
      "20  121  157   5   3  0  4                  5  D3/791    None  \n",
      "21   83   21   0   4  0  0                  0       D    None  \n",
      "\n",
      "[22 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_3 = homerun()#Adam Dunn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#0,1,2,3,12,13,20,21"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "Data_3 = Data_3.drop([0,1,2,3,12,13,20,21], axis=0)\n",
    "X_3_origin = clean(Data_3) #floot\n",
    "Y_3_origin = output_y(X_3_origin)\n",
    "X_3_finish = X_3_origin.values\n",
    "num = Y_3_origin.count()\n",
    "x_3_train = X_3_finish[:10]#最後一個不要[0:10]\n",
    "x_3_test = X_3_finish[10:num-1]#[10:num-1]\n",
    "Y_3_finish = Y_3_origin.values\n",
    "y_3_train = Y_3_finish[1:11]#[1:11]\n",
    "y_3_test = Y_3_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/f/fieldpr01.shtml\n",
      "    year Age       Tm       Lg    G   PA   AB    R    H  2B     ...       \\\n",
      "0   2002  18  MIL-min     Rk,A   73  317  258   50   84  19     ...        \n",
      "1   2003  19  MIL-min        A  137  594  502   81  157  22     ...        \n",
      "2   2004  20  MIL-min       AA  135  577  497   70  135  29     ...        \n",
      "3   2005  21  MIL-min  AAA,Fal  109  465  399   73  113  22     ...        \n",
      "4   2005  21      MIL       NL   39   62   59    2   17   4     ...        \n",
      "5   2006  22      MIL       NL  157  648  569   82  154  35     ...        \n",
      "6   2007  23      MIL       NL  158  681  573  109  165  35     ...        \n",
      "7   2008  24      MIL       NL  159  694  588   86  162  30     ...        \n",
      "8   2009  25      MIL       NL  162  719  591  103  177  35     ...        \n",
      "9   2010  26      MIL       NL  161  714  578   94  151  25     ...        \n",
      "10  2011  27      MIL       NL  162  692  569   95  170  36     ...        \n",
      "11  2012  28      DET       AL  162  690  581   83  182  33     ...        \n",
      "12  2013  29      DET       AL  162  712  624   82  174  36     ...        \n",
      "13  2014  30      TEX       AL   42  178  150   19   37   8     ...        \n",
      "14  2015  31      TEX       AL  158  693  613   78  187  28     ...        \n",
      "15  2016  32      TEX       AL   89  370  326   29   69  16     ...        \n",
      "\n",
      "      OPS OPS+   TB GDP HBP SH  SF                  IBB   Pos       Awards  \n",
      "0    .998  142    3  11   0  1   1  OGD,BEL · PION,MIDW  None         None  \n",
      "1    .935  264   14  15   0  6  16           BEL · MIDW  None         None  \n",
      "2    .839  235   11  11   0  4   6           HVL · SOUL  None         None  \n",
      "3    .945  225   12   7   0  2   4   NVL,PEA · PCL,AZFL  None         None  \n",
      "4    .764   97   27   0   0  0   1                    0   /3D         None  \n",
      "5    .831  110  275  17  12  0   8                    5  *3/D        RoY-7  \n",
      "6   1.013  157  354   9  14  0   4                   21  *3/D  AS,MVP-3,SS  \n",
      "7    .879  130  298  12  12  0  10                   19  *3/D       MVP-20  \n",
      "8   1.014  166  356  14   9  0   9                   21    *3     AS,MVP-4  \n",
      "9    .871  135  272  12  21  0   1                   17  *3/D         None  \n",
      "10   .981  164  322  17  10  0   6                   32  *3/D  AS,MVP-3,SS  \n",
      "11   .940  151  307  19  17  0   7                   18  *3/D  AS,MVP-9,SS  \n",
      "12   .819  122  285  20   9  0   4                    5   *3D           AS  \n",
      "13   .720  102   54   5   2  0   1                   11   3/D         None  \n",
      "14   .841  126  284  21  11  0   5                   14   *D3    AS,MVP-13  \n",
      "15   .626   65  109  12   7  0   5                    1   D/3         None  \n",
      "\n",
      "[16 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_4 = homerun()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 214,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 0,1,2,3,15"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "Data_4 = Data_4.drop([0,1,2,3], axis=0)\n",
    "X_4_origin = clean(Data_4) #floot\n",
    "Y_4_origin = output_y(X_4_origin)\n",
    "X_4_finish = X_4_origin.values\n",
    "num = Y_4_origin.count()\n",
    "x_4_train = X_4_finish[:10]#最後一個不要[0:10]\n",
    "x_4_test = X_4_finish[10:num-1]#[10:num-1]\n",
    "Y_4_finish = Y_4_origin.values\n",
    "y_4_train = Y_4_finish[1:11]#[1:11]\n",
    "y_4_test = Y_4_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/g/gonzaju03.shtml\n",
      "    year Age       Tm   Lg    G   PA   AB    R    H  2B     ...         OPS  \\\n",
      "0   1986  16  TEX-min   Rk   60  259  233   24   56   4     ...        .568   \n",
      "1   1987  17  TEX-min    A  127  549  509   69  135  21     ...        .707   \n",
      "2   1988  18  TEX-min    A   77  308  277   25   71  14     ...        .740   \n",
      "3   1989  19  TEX-min   AA  133  547  502   73  147  30     ...        .848   \n",
      "4   1989  19      TEX   AL   24   68   60    6    9   3     ...        .477   \n",
      "5   1990  20  TEX-min  AAA  128  537  496   78  128  29     ...        .808   \n",
      "6   1990  20      TEX   AL   25   95   90   11   26   7     ...        .838   \n",
      "7   1991  21      TEX   AL  142  595  545   78  144  34     ...        .800   \n",
      "8   1992  22      TEX   AL  155  632  584   77  152  24     ...        .833   \n",
      "9   1993  23      TEX   AL  140  587  536  105  166  33     ...       1.000   \n",
      "10  1994  24      TEX   AL  107  463  422   57  116  18     ...        .802   \n",
      "11  1995  25      TEX   AL   90  374  352   57  104  20     ...        .917   \n",
      "12  1996  26      TEX   AL  134  592  541   89  170  33     ...       1.011   \n",
      "13  1997  27      TEX   AL  133  579  533   87  158  24     ...        .924   \n",
      "14  1998  28      TEX   AL  154  669  606  110  193  50     ...        .997   \n",
      "15  1999  29      TEX   AL  144  629  562  114  183  36     ...        .980   \n",
      "16  2000  30      DET   AL  115  496  461   69  133  30     ...        .842   \n",
      "17  2001  31      CLE   AL  140  595  532   97  173  34     ...        .960   \n",
      "18  2002  32      TEX   AL   70  296  277   38   78  21     ...        .776   \n",
      "19  2003  33      TEX   AL   82  346  327   49   96  17     ...        .901   \n",
      "20  2004  34  KCR-min   Rk    9   33   26    6    9   5     ...        .993   \n",
      "21  2004  34      KCR   AL   33  138  127   17   35   4     ...        .767   \n",
      "22  2005  35  CLE-min  AAA    5   21   21    1    6   0     ...        .571   \n",
      "23  2005  35      CLE   AL    1    1    1    0    0   0     ...        .000   \n",
      "24  2006  36      LGI  Ind   36  146  130   23   42   7     ...        .892   \n",
      "\n",
      "    OPS+   TB GDP HBP SH          SF         IBB     Pos       Awards  \n",
      "0     62    1   1   3  0  RGS · GULF        None    None         None  \n",
      "1    202    5   1   4  2  GST · SALL        None    None         None  \n",
      "2    115    7   4   0  2           3  POE · FLOR    None         None  \n",
      "3    254    9   1   4  3    TUL · TL        None    None         None  \n",
      "4     34   15   4   0  2           0           0     8/7         None  \n",
      "5    252    1   0   8  2    OKC · AA        None    None         None  \n",
      "6    131   47   2   2  0           1           0   8/D97         None  \n",
      "7    121  261  10   5  0           3           7  *87/9D         None  \n",
      "8    133  309  16   5  0           8           1  *87/D9    MVP-16,SS  \n",
      "9    169  339  12  13  0           1           7     *7D  AS,MVP-4,SS  \n",
      "10   105  199  18   7  0           4          10      *7         None  \n",
      "11   130  209  15   0  0           5           3     D/7         None  \n",
      "12   145  348  10   3  0           3          12      9D     MVP-1,SS  \n",
      "13   131  314  12   3  0          10           7      D9     MVP-9,SS  \n",
      "14   149  382  20   6  0          11           9     *9D  AS,MVP-1,SS  \n",
      "15   141  338  10   4  0          12           7     *9D       MVP-13  \n",
      "16   116  233  13   2  0           1           3      9D         None  \n",
      "17   148  314  18   6  0          16           5     *9D  AS,MVP-5,SS  \n",
      "18    99  125  11   1  0           1           1     9/D         None  \n",
      "19   122  187  10   4  0           1           1      9D         None  \n",
      "20    14    1   0   0  1           0  ROY · ARIZ    None         None  \n",
      "21    97   56   3   1  0           1           1     9/D         None  \n",
      "22     6    1   0   0  0           0    BFL · IL    None         None  \n",
      "23  -100    0   0   0  0           0           0    None         None  \n",
      "24    67    3   4   0  3           0  LGI · ATLL    None         None  \n",
      "\n",
      "[25 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_5 = homerun()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 0,1,2,3,5,20,22"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "Data_5 = Data_5.drop([0,1,2,3,5,20,22], axis=0)\n",
    "X_5_origin = clean(Data_5) #floot\n",
    "Y_5_origin = output_y(X_5_origin)\n",
    "X_5_finish = X_5_origin.values\n",
    "num = Y_5_origin.count()\n",
    "x_5_train = X_5_finish[:10]#最後一個不要[0:10]\n",
    "x_5_test = X_5_finish[10:num-1]#[10:num-1]\n",
    "Y_5_finish = Y_5_origin.values\n",
    "y_5_train = Y_5_finish[1:11]#[1:11]\n",
    "y_5_test = Y_5_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/l/leede02.shtml\n",
      "    year Age       Tm     Lg    G   PA   AB    R    H  2B       ...        \\\n",
      "0   1993  17  SDP-min  A+,Rk   35  142  125   24   37   6       ...         \n",
      "1   1994  18  SDP-min     A+  126  497  442   66  118  19       ...         \n",
      "2   1995  19  SDP-min  A+,AA  130  574  511   82  152  25       ...         \n",
      "3   1996  20  SDP-min     AA  134  575  500   98  140  39       ...         \n",
      "4   1997  21  SDP-min    AAA  125  534  472   86  153  29       ...         \n",
      "5   1997  21      SDP     NL   22   63   54    9   14   3       ...         \n",
      "6   1998  22      FLA     NL  141  513  454   62  106  29       ...         \n",
      "7   1999  23  FLA-min    AAA   89  377  339   60   96  20       ...         \n",
      "8   1999  23      FLA     NL   70  236  218   21   45   9       ...         \n",
      "9   2000  24      FLA     NL  158  546  477   70  134  18       ...         \n",
      "10  2001  25      FLA     NL  158  625  561   83  158  37       ...         \n",
      "11  2002  26      FLA     NL  162  688  581   95  157  35       ...         \n",
      "12  2003  27      FLA     NL  155  643  539   91  146  31       ...         \n",
      "13  2004  28      CHC     NL  161  688  605   90  168  39       ...         \n",
      "14  2005  29      CHC     NL  158  691  594  120  199  50       ...         \n",
      "15  2006  30  CHC-min    AAA    1    4    4    0    1   0       ...         \n",
      "16  2006  30      CHC     NL   50  204  175   30   50   9       ...         \n",
      "17  2007  31      CHC     NL  150  650  567   91  180  43       ...         \n",
      "18  2008  32      CHC     NL  155  698  623   93  181  41       ...         \n",
      "19  2009  33      CHC     NL  141  615  532   91  163  36       ...         \n",
      "20  2010  34      TOT     NL  148  626  547   80  142  35       ...         \n",
      "21  2010  34      CHC     NL  109  475  418   63  105  21       ...         \n",
      "22  2010  34      ATL     NL   39  151  129   17   37  14       ...         \n",
      "23  2011  35  BAL-min     AA    1    4    3    0    2   0       ...         \n",
      "24  2011  35      TOT    MLB  113  477  435   55  116  17       ...         \n",
      "25  2011  35      BAL     AL   85  364  334   39   82  15       ...         \n",
      "26  2011  35      PIT     NL   28  113  101   16   34   2       ...         \n",
      "\n",
      "      OPS OPS+   TB GDP HBP SH SF                  IBB   Pos          Awards  \n",
      "0    .828   56    1   1   0  0  1  RCU,PDS · CALL,ARIZ  None            None  \n",
      "1    .709  165   11   7   0  6  2           RCU · CALL  None            None  \n",
      "2    .852  250    8   7   0  7  2  RCU,MEM · CALL,SOUL  None            None  \n",
      "3    .930  285    8   2   0  8  3           MEM · SOUL  None            None  \n",
      "4    .876  225    9   0   0  2  4            LVG · PCL  None            None  \n",
      "5    .735  100   20   1   0  0  0                    0     3            None  \n",
      "6    .732   96  188  12  10  0  2                    1    *3            None  \n",
      "7    .861  175    7   4   0  4  2            CGY · PCL  None            None  \n",
      "8    .588   53   71   3   0  0  1                    1     3            None  \n",
      "9    .875  124  242  14   4  0  2                    6    *3            None  \n",
      "10   .820  113  266  18   8  0  6                    1    *3            None  \n",
      "11   .872  131  287  14   5  0  4                    8    *3            None  \n",
      "12   .888  131  274   9  10  0  6                    7    *3       MVP-27,GG  \n",
      "13   .860  118  305  14   8  2  5                    4    *3            None  \n",
      "14  1.080  174  393  12   5  0  7                   23    *3  AS,MVP-3,GG,SS  \n",
      "15   .500    1    0   0   0  0  0            IWA · PCL  None            None  \n",
      "16   .842  112   83  11   0  0  4                    1   3/D            None  \n",
      "17   .913  130  291  15   9  0  3                    8  *3/D           AS,GG  \n",
      "18   .823  109  288  27   0  0  4                    3  *3/D          MVP-21  \n",
      "19   .972  146  308  12   3  0  4                    6  *3/D           MVP-9  \n",
      "20   .774  106  234  23   2  0  4                    1  *3/D            None  \n",
      "21   .751   98  174  16   2  0  3                    1   3/D            None  \n",
      "22   .849  130   60   7   0  0  1                    0     3            None  \n",
      "23  1.417    2    0   0   0  0  0             BOW · EL  None            None  \n",
      "24   .771  109  194  14   6  0  3                    2    *3            None  \n",
      "25   .706   91  135  13   3  0  2                    2     3            None  \n",
      "26   .982  173   59   1   3  0  1                    0     3            None  \n",
      "\n",
      "[27 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_6 = homerun()#Derrek Lee"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#0,1,2,3,4,7,15,21,22,23,25,26"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "Data_6 = Data_6.drop([0,1,2,3,4,7,15,21,22,23,25,26], axis=0)\n",
    "X_6_origin = clean(Data_6) #floot\n",
    "Y_6_origin = output_y(X_6_origin)\n",
    "X_6_finish = X_6_origin.values\n",
    "num = Y_6_origin.count()\n",
    "x_6_train = X_6_finish[:10]#最後一個不要[0:10]\n",
    "x_6_test = X_6_finish[10:num-1]#[10:num-1]\n",
    "Y_6_finish = Y_6_origin.values\n",
    "y_6_train = Y_6_finish[1:11]#[1:11]\n",
    "y_6_test = Y_6_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/p/penaca01.shtml\n",
      "    year Age           Tm       Lg    G   PA   AB    R    H  2B    ...     \\\n",
      "0   1998  20      TEX-min  A,A+,Rk   39  163  144   24   46  15    ...      \n",
      "1   1999  21      TEX-min       A+  136  597  501   85  128  31    ...      \n",
      "2   2000  22      TEX-min       AA  138  648  529  117  158  36    ...      \n",
      "3   2001  23      TEX-min      AAA  119  519  431   71  124  38    ...      \n",
      "4   2001  23          TEX       AL   22   72   62    6   16   4    ...      \n",
      "5   2002  24      OAK-min      AAA   44  206  175   30   42  10    ...      \n",
      "6   2002  24          TOT       AL  115  443  397   43   96  17    ...      \n",
      "7   2002  24          OAK       AL   40  141  124   12   27   4    ...      \n",
      "8   2002  24          DET       AL   75  302  273   31   69  13    ...      \n",
      "9   2003  25      DET-min      AAA    8   35   30    4   10   4    ...      \n",
      "10  2003  25          DET       AL  131  516  452   51  112  21    ...      \n",
      "11  2004  26          DET       AL  142  562  481   89  116  22    ...      \n",
      "12  2005  27      DET-min      AAA   71  309  257   43   80  17    ...      \n",
      "13  2005  27          DET       AL   79  295  260   37   61   9    ...      \n",
      "14  2006  28  BOS-NYY-min  AAA,FgW  133  578  472   80  127  21    ...      \n",
      "15  2006  28          BOS       AL   18   37   33    3    9   2    ...      \n",
      "16  2007  29          TBD       AL  148  612  490   99  138  29    ...      \n",
      "17  2008  30      TBR-min       A+    1    5    4    0    0   0    ...      \n",
      "18  2008  30          TBR       AL  139  607  490   76  121  24    ...      \n",
      "19  2009  31          TBR       AL  135  570  471   91  107  25    ...      \n",
      "20  2010  32      TBR-min       A+    1    3    3    1    2   0    ...      \n",
      "21  2010  32          TBR       AL  144  582  484   64   95  18    ...      \n",
      "22  2011  33          CHC       NL  153  606  493   72  111  27    ...      \n",
      "23  2012  34          TBR       AL  160  600  497   72   98  17    ...      \n",
      "24  2013  35      KCR-min      AAA    5   22   18    5    6   0    ...      \n",
      "25  2013  35          TOT       AL   89  328  280   38   58  13    ...      \n",
      "26  2013  35          HOU       AL   85  325  277   38   58  13    ...      \n",
      "27  2013  35          KCR       AL    4    3    3    0    0   0    ...      \n",
      "28  2014  36      TEX-min      AAA   20   80   74   12   22   3    ...      \n",
      "29  2014  36          TEX       AL   18   63   59    4    8   3    ...      \n",
      "\n",
      "      OPS  OPS+   TB GDP HBP  SH  SF                           IBB   Pos  \\\n",
      "0    .941    79    0   5   0   1   0  SAV,CHT,RGS · SALL,FLOR,GULF  None   \n",
      "1    .822   229    7  16   0   6   2                    CHT · FLOR  None   \n",
      "2    .947   282    7   9   1   8  10                      TUL · TL  None   \n",
      "3    .958   237    6   8   0   0   1                     OKC · PCL  None   \n",
      "4    .861   121   31   1   0   0   0                             0   3/D   \n",
      "5    .820    84    3   4   0   3   0                     SAC · PCL  None   \n",
      "6    .764   106  178   7   3   0   2                             0  *3/D   \n",
      "7    .724    92   52   2   1   0   1                             0     3   \n",
      "8    .783   113  126   5   2   0   1                             0   3/D   \n",
      "9    .962    16    0   1   0   0   1                      TOL · IL  None   \n",
      "10   .772   108  199   6   6   1   4                             1  *3/D   \n",
      "11   .810   114  227  11   3   2   5                             2  *3/D   \n",
      "12   .949   135    4   6   0   1   5                      TOL · IL  None   \n",
      "13   .802   113  124   3   4   0   0                             2    3D   \n",
      "14   .871   229    4  12   0  10   5         PAW,CLB,LCY · IL,DOWL  None   \n",
      "15   .776    96   14   1   0   0   0                             0   3/7   \n",
      "16  1.037   172  307   7  10   1   8                            10  *3/D   \n",
      "17   .200     0    0   0   0   0   0                    VRO · FLOR  None   \n",
      "18   .871   129  242   6  12   0   9                             7  *3/D   \n",
      "19   .893   133  253   5   9   0   3                            11    *3   \n",
      "20  1.333     2    0   0   0   0   0                    POE · FLOR  None   \n",
      "21   .732   103  197   2   7   0   4                             4  *3/D   \n",
      "22   .819   123  228   6   4   1   7                             7    *3   \n",
      "23   .684    93  176  10  13   0   3                             2  *3/D   \n",
      "24  1.232    14    0   0   0   0   0                     OMA · PCL  None   \n",
      "25   .668    86   97   5   4   1   0                             5    3D   \n",
      "26   .674    88   97   5   4   1   0                             5    3D   \n",
      "27   .000  -100    0   0   0   0   0                             0    /3   \n",
      "28   .850    37    2   1   0   0   1                     RRK · PCL  None   \n",
      "29   .428    19   14   1   0   0   0                             0     3   \n",
      "\n",
      "      Awards  \n",
      "0       None  \n",
      "1       None  \n",
      "2       None  \n",
      "3       None  \n",
      "4       None  \n",
      "5       None  \n",
      "6      RoY-8  \n",
      "7       None  \n",
      "8       None  \n",
      "9       None  \n",
      "10      None  \n",
      "11      None  \n",
      "12      None  \n",
      "13      None  \n",
      "14      None  \n",
      "15      None  \n",
      "16  MVP-9,SS  \n",
      "17      None  \n",
      "18  MVP-9,GG  \n",
      "19        AS  \n",
      "20      None  \n",
      "21      None  \n",
      "22      None  \n",
      "23      None  \n",
      "24      None  \n",
      "25      None  \n",
      "26      None  \n",
      "27      None  \n",
      "28      None  \n",
      "29      None  \n",
      "\n",
      "[30 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_7 = homerun()#Carlos Peña"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#0,1,2,3,5,9,12,14,17,20,24,28"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "Data_7 = Data_7.drop([0,1,2,3,5,7,8,9,12,14,17,20,24,26,27,28], axis=0)\n",
    "X_7_origin = clean(Data_7) #floot\n",
    "Y_7_origin = output_y(X_7_origin)\n",
    "X_7_finish = X_7_origin.values\n",
    "num = Y_7_origin.count()\n",
    "x_7_train = X_7_finish[:10]#最後一個不要[0:10]\n",
    "x_7_test = X_7_finish[10:num-1]#[10:num-1]\n",
    "Y_7_finish = Y_7_origin.values\n",
    "y_7_train = Y_7_finish[1:11]#[1:11]\n",
    "y_7_test = Y_7_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/g/griffke02.shtml\n",
      "    year Age       Tm    Lg    G   PA   AB    R    H  2B       ...         \\\n",
      "0   1987  17  SEA-min    A-   54  228  182   43   57   9       ...          \n",
      "1   1988  18  SEA-min  A,AA   75  324  280   60   91  18       ...          \n",
      "2   1989  19      SEA    AL  127  506  455   61  120  23       ...          \n",
      "3   1990  20      SEA    AL  155  666  597   91  179  28       ...          \n",
      "4   1991  21      SEA    AL  154  633  548   76  179  42       ...          \n",
      "5   1992  22      SEA    AL  142  617  565   83  174  39       ...          \n",
      "6   1993  23      SEA    AL  156  691  582  113  180  38       ...          \n",
      "7   1994  24      SEA    AL  111  493  433   94  140  24       ...          \n",
      "8   1995  25  SEA-min   AAA    1    3    3    0    0   0       ...          \n",
      "9   1995  25      SEA    AL   72  314  260   52   67   7       ...          \n",
      "10  1996  26      SEA    AL  140  638  545  125  165  26       ...          \n",
      "11  1997  27      SEA    AL  157  704  608  125  185  34       ...          \n",
      "12  1998  28      SEA    AL  161  720  633  120  180  33       ...          \n",
      "13  1999  29      SEA    AL  160  706  606  123  173  26       ...          \n",
      "14  2000  30      CIN    NL  145  631  520  100  141  22       ...          \n",
      "15  2001  31      CIN    NL  111  417  364   57  104  20       ...          \n",
      "16  2002  32      CIN    NL   70  232  197   17   52   8       ...          \n",
      "17  2003  33      CIN    NL   53  201  166   34   41  12       ...          \n",
      "18  2004  34      CIN    NL   83  348  300   49   76  18       ...          \n",
      "19  2005  35      CIN    NL  128  555  491   85  148  30       ...          \n",
      "20  2006  36      CIN    NL  109  472  428   62  108  19       ...          \n",
      "21  2007  37      CIN    NL  144  623  528   78  146  24       ...          \n",
      "22  2008  38      TOT   MLB  143  575  490   67  122  30       ...          \n",
      "23  2008  38      CIN    NL  102  425  359   51   88  20       ...          \n",
      "24  2008  38      CHW    AL   41  150  131   16   34  10       ...          \n",
      "25  2009  39      SEA    AL  117  454  387   44   83  19       ...          \n",
      "26  2010  40      SEA    AL   33  108   98    6   18   2       ...          \n",
      "\n",
      "      OPS OPS+   TB GDP HBP SH          SF                IBB      Pos  \\\n",
      "0   1.049  110    0   1   1  3  BLH · NORW               None     None   \n",
      "1    .972  156    3   4   1  0           5  SBR,VMT · CALL,EL     None   \n",
      "2    .748  108  191   4   2  1           4                  8       *8   \n",
      "3    .847  136  287  12   2  0           4                 12     *8/D   \n",
      "4    .926  155  289  10   1  4           9                 21     *8/D   \n",
      "5    .896  149  302  15   5  0           3                 15     *8/D   \n",
      "6   1.025  171  359  14   6  0           7                 25    *8D/3   \n",
      "7   1.076  171  292   9   2  0           2                 19    *8/D9   \n",
      "8    .000    0    0   0   0  0           0          TAC · PCL     None   \n",
      "9    .860  122  125   4   0  0           2                  6      8/D   \n",
      "10  1.020  154  342   7   7  1           7                 13     *8/D   \n",
      "11  1.028  165  393  12   8  0          12                 23    *8/D7   \n",
      "12   .977  150  387  14   7  0           4                 11  *8/D379   \n",
      "13   .960  139  349   8   7  0           2                 17     *8/D   \n",
      "14   .942  133  289   7   9  0           8                 17       *8   \n",
      "15   .898  124  194   8   4  1           4                  6      8/D   \n",
      "16   .784  103   84   6   3  0           4                  6     8/79   \n",
      "17   .936  145   94   3   6  1           1                  5      8/D   \n",
      "18   .864  123  154   8   2  0           2                  3     8/D9   \n",
      "19   .946  144  283   9   3  0           7                  3     *8/D   \n",
      "20   .802   99  208  13   2  0           3                  6      8/D   \n",
      "21   .869  119  262  14   1  0           9                 14     *9/D   \n",
      "22   .778  102  208  13   3  0           4                 14     *98D   \n",
      "23   .787  104  155   7   2  0           3                 13      9/D   \n",
      "24   .751   96   53   6   1  0           1                  1     8/D9   \n",
      "25   .735   97  159   6   1  0           3                  2     D/79   \n",
      "26   .454   30   20   3   0  0           1                  0        D   \n",
      "\n",
      "             Awards  \n",
      "0              None  \n",
      "1              None  \n",
      "2             RoY-3  \n",
      "3      AS,MVP-19,GG  \n",
      "4    AS,MVP-9,GG,SS  \n",
      "5      AS,MVP-17,GG  \n",
      "6    AS,MVP-5,GG,SS  \n",
      "7    AS,MVP-2,GG,SS  \n",
      "8              None  \n",
      "9             AS,GG  \n",
      "10   AS,MVP-4,GG,SS  \n",
      "11   AS,MVP-1,GG,SS  \n",
      "12   AS,MVP-4,GG,SS  \n",
      "13  AS,MVP-10,GG,SS  \n",
      "14               AS  \n",
      "15             None  \n",
      "16             None  \n",
      "17             None  \n",
      "18               AS  \n",
      "19           MVP-24  \n",
      "20             None  \n",
      "21               AS  \n",
      "22             None  \n",
      "23             None  \n",
      "24             None  \n",
      "25             None  \n",
      "26             None  \n",
      "\n",
      "[27 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_8 = homerun()#Ken Griffey"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 243,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#0,1,8,23,24"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "Data_8 = Data_8.drop([0,1,8,23,24], axis=0)\n",
    "X_8_origin = clean(Data_8) #floot\n",
    "Y_8_origin = output_y(X_8_origin)\n",
    "X_8_finish = X_8_origin.values\n",
    "num = Y_8_origin.count()\n",
    "x_8_train = X_8_finish[:10]#最後一個不要[0:10]\n",
    "x_8_test = X_8_finish[10:num-1]#[10:num-1]\n",
    "Y_8_finish = Y_8_origin.values\n",
    "y_8_train = Y_8_finish[1:11]#[1:11]\n",
    "y_8_test = Y_8_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "請輸入網址http://www.baseball-reference.com/players/h/howarry01.shtml\n",
      "    year Age       Tm          Lg    G   PA   AB    R    H  2B     ...       \\\n",
      "0   2001  21  PHI-min          A-   48  203  169   26   46   7     ...        \n",
      "1   2002  22  PHI-min           A  135  570  493   56  138  20     ...        \n",
      "2   2003  23  PHI-min          A+  130  553  490   67  149  32     ...        \n",
      "3   2004  24  PHI-min  AA,AAA,Fal  131  560  485   94  141  28     ...        \n",
      "4   2004  24      PHI          NL   19   42   39    5   11   5     ...        \n",
      "5   2005  25  PHI-min         AAA   61  257  210   38   78  19     ...        \n",
      "6   2005  25      PHI          NL   88  348  312   52   90  17     ...        \n",
      "7   2006  26      PHI          NL  159  704  581  104  182  25     ...        \n",
      "8   2007  27  PHI-min           A    2    8    6    1    2   1     ...        \n",
      "9   2007  27      PHI          NL  144  648  529   94  142  26     ...        \n",
      "10  2008  28      PHI          NL  162  700  610  105  153  26     ...        \n",
      "11  2009  29      PHI          NL  160  703  616  105  172  37     ...        \n",
      "12  2010  30  PHI-min           A    1    3    2    0    1   1     ...        \n",
      "13  2010  30      PHI          NL  143  620  550   87  152  23     ...        \n",
      "14  2011  31      PHI          NL  152  644  557   81  141  30     ...        \n",
      "15  2012  32  PHI-min       AAA,A    7   26   20    3   10   2     ...        \n",
      "16  2012  32      PHI          NL   71  292  260   28   57  11     ...        \n",
      "17  2013  33      PHI          NL   80  317  286   34   76  20     ...        \n",
      "18  2014  34      PHI          NL  153  648  569   65  127  18     ...        \n",
      "19  2015  35      PHI          NL  129  503  467   53  107  29     ...        \n",
      "20  2016  36      PHI          NL  112  362  331   35   65  10     ...        \n",
      "21  2017  37  ATL-min         AAA   11   42   38    1    7   0     ...        \n",
      "\n",
      "      OPS OPS+   TB GDP HBP SH  SF                       IBB   Pos  \\\n",
      "0    .840   77    1   2   0  2   5                BAT · NYPL  None   \n",
      "1    .828  227    9   5   1  5  13                LWD · SALL  None   \n",
      "2    .889  252   12   8   0  5   9                CLW · FLOR  None   \n",
      "3   1.017  309    6  12   0  3   7  REA,SWB,PHO · EL,IL,AZFL  None   \n",
      "4    .897  122   22   2   1  0   0                         0    /3   \n",
      "5   1.157  145    3   3   0  5   6                  SWB · IL  None   \n",
      "6    .924  133  177   6   1  0   2                         8     3   \n",
      "7   1.084  167  383   7   9  0   6                        37    *3   \n",
      "8   1.500    6    1   0   0  0   0                LWD · SALL  None   \n",
      "9    .976  144  309  13   5  0   7                        35  *3/D   \n",
      "10   .881  125  331  11   3  0   6                        17  *3/D   \n",
      "11   .931  141  352  11   6  0   6                         8  *3/D   \n",
      "12  1.667    2    0   0   0  0   0                LWD · SALL  None   \n",
      "13   .859  127  278  14   8  0   3                        11  *3/D   \n",
      "14   .835  126  272  10   7  0   5                        16  *3/D   \n",
      "15  1.327   15    1   0   0  1   0         LHV,LWD · IL,SALL  None   \n",
      "16   .718   91  110   8   4  0   3                         7     3   \n",
      "17   .784  115  133   6   2  0   6                         4     3   \n",
      "18   .690   92  216  10   7  0   5                         7  *3/D   \n",
      "19   .720   96  207  11   5  0   3                         2  *3/D   \n",
      "20   .710   86  150   7   1  0   3                         2   3/D   \n",
      "21   .501   10    0   1   0  1   1                  GWI · IL  None   \n",
      "\n",
      "         Awards  \n",
      "0          None  \n",
      "1          None  \n",
      "2          None  \n",
      "3          None  \n",
      "4          None  \n",
      "5          None  \n",
      "6         RoY-1  \n",
      "7   AS,MVP-1,SS  \n",
      "8          None  \n",
      "9         MVP-5  \n",
      "10        MVP-2  \n",
      "11     AS,MVP-3  \n",
      "12         None  \n",
      "13    AS,MVP-10  \n",
      "14       MVP-10  \n",
      "15         None  \n",
      "16         None  \n",
      "17         None  \n",
      "18         None  \n",
      "19         None  \n",
      "20         None  \n",
      "21         None  \n",
      "\n",
      "[22 rows x 30 columns]\n"
     ]
    }
   ],
   "source": [
    "Data_9 = homerun()#Ryan Howard"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#0,1,2,3,5,8,12,15,21"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "Data_9 = Data_9.drop([0,1,2,3,5,8,12,15,21], axis=0)\n",
    "X_9_origin = clean(Data_9) #floot\n",
    "Y_9_origin = output_y(X_9_origin)\n",
    "X_9_finish = X_9_origin.values\n",
    "num = Y_9_origin.count()\n",
    "x_9_train = X_9_finish[:10]#最後一個不要[0:10]\n",
    "x_9_test = X_9_finish[10:num-1]#[10:num-1]\n",
    "Y_9_finish = Y_9_origin.values\n",
    "y_9_train = Y_9_finish[1:11]#[1:11]\n",
    "y_9_test = Y_9_finish[11:num]#最前一個不要，[11:num]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "x_train = np.concatenate((x_1_train, x_2_train,x_3_train,x_4_train,x_5_train,x_6_train,x_7_train,x_8_train,x_9_train))\n",
    "y_train = np.concatenate((y_1_train, y_2_train,y_3_train,y_4_train,y_5_train,y_6_train,y_7_train,y_8_train,y_9_train))\n",
    "x_test = np.concatenate((x_1_test, x_2_test,x_3_test,x_4_test,x_5_test,x_6_test,x_7_test,x_8_test,x_9_test))\n",
    "y_test = np.concatenate((y_1_test, y_2_test,y_3_test,y_4_test,y_5_test,y_6_test,y_7_test,y_8_test,y_9_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "44"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(x_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([ 12.,  16.,  20.,  15.,  23.,   4.]),\n",
       " array([ 0, 10, 20, 30, 40, 50, 60]),\n",
       " <a list of 6 Patch objects>)"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAXQAAAD8CAYAAABn919SAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz\nAAALEgAACxIB0t1+/AAAC6FJREFUeJzt3H+o3fddx/Hny2WidsOl5hrC1ngntJMgNpVL7ViRrjUj\nK2LnP7KCErAQ/5jS1YG0Cv7Af/aPi/4hg2hrC86KbKsto2zcZoUiyGayZVvatMmcGUtIe1uGbPqH\n2u7tH/cbvYbc3R/n3Hvu9+3zAZdzzvd8c7+fN0me+eZ77jmpKiRJ4/cDs16AJGk6DLokNWHQJakJ\ngy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCZ2befB9uzZU/Pz89t5SEkavVOnTr1WVXNr7betQZ+f\nn+fkyZPbeUhJGr0k31zPfl5ykaQmDLokNWHQJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCa2\n9Z2ikrbescVzs17C1Dxw6KZZL2FUPEOXpCYMuiQ1YdAlqQmDLklNGHRJasKgS1ITBl2SmjDoktSE\nQZekJgy6JDVh0CWpCYMuSU0YdElqwqBLUhMGXZKaMOiS1IRBl6QmDLokNWHQJakJgy5JTRh0SWrC\noEtSE2sGPckNSZ5N8kKS55PcP2y/PslikvPD7e6tX64kaTXrOUN/HfhIVR0AbgM+lOQA8CBwoqpu\nBE4MjyVJM7Jm0KvqclV9abj/XeAs8HbgHuCxYbfHgA9s1SIlSWvb0DX0JPPALcAXgL1VdXl46mVg\n71RXJknakF3r3THJW4BPAR+uqu8k+Z/nqqqS1Cq/7ihwFGD//v2TrVY7zrHFc7NewlQ8cOimWS9B\nmti6ztCTvJnlmH+iqj49bH4lyb7h+X3A0rV+bVUdr6qFqlqYm5ubxpolSdewnp9yCfAwcLaqPrbi\nqaeAI8P9I8CT01+eJGm91nPJ5T3ArwFfS3J62Pa7wEeBv0tyH/BN4Fe2ZomSpPVYM+hV9Q9AVnn6\nrukuR5K0Wb5TVJKaMOiS1IRBl6QmDLokNWHQJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCYM\nuiQ1YdAlqQmDLklNGHRJasKgS1ITBl2SmjDoktSEQZekJgy6JDVh0CWpCYMuSU0YdElqwqBLUhMG\nXZKaMOiS1IRBl6QmDLokNWHQJakJgy5JTRh0SWpi16wX8P/RscVzs16CpIY8Q5ekJgy6JDVh0CWp\nCYMuSU2sGfQkjyRZSnJmxbY/THIpyenh6+6tXaYkaS3rOUN/FDh8je3Hqurg8PX0dJclSdqoNYNe\nVc8B396GtUiSJjDJNfTfSvLV4ZLM7qmtSJK0KZt9Y9HHgT8Garj9E+DXr7VjkqPAUYD9+/dv8nDS\n1vLNXupgU2foVfVKVb1RVd8D/gK49fvse7yqFqpqYW5ubrPrlCStYVNBT7JvxcNfBs6stq8kaXus\necklyePAHcCeJBeBPwDuSHKQ5UsuF4Df2MI1SpLWYc2gV9W919j88BasRZI0Ad8pKklNGHRJasKg\nS1ITBl2SmjDoktSEQZekJgy6JDVh0CWpCYMuSU0YdElqwqBLUhMGXZKaMOiS1IRBl6QmDLokNWHQ\nJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCZ2zXoB63Vs8dyslyBJO5pn6JLUhEGXpCYMuiQ1\nYdAlqQmDLklNGHRJasKgS1ITBl2SmjDoktSEQZekJgy6JDVh0CWpCYMuSU2sGfQkjyRZSnJmxbbr\nkywmOT/c7t7aZUqS1rKeM/RHgcNXbXsQOFFVNwInhseSpBlaM+hV9Rzw7as23wM8Ntx/DPjAlNcl\nSdqgzV5D31tVl4f7LwN7p7QeSdImTfyiaFUVUKs9n+RokpNJTr766quTHk6StIrNBv2VJPsAhtul\n1XasquNVtVBVC3Nzc5s8nCRpLZsN+lPAkeH+EeDJ6SxHkrRZ6/mxxceBfwTeleRikvuAjwKHkpwH\nfmF4LEmaoV1r7VBV967y1F1TXoskaQK+U1SSmjDoktSEQZekJgy6JDVh0CWpCYMuSU0YdElqwqBL\nUhMGXZKaMOiS1IRBl6QmDLokNWHQJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCYMuiQ1YdAl\nqQmDLklNGHRJasKgS1ITBl2SmjDoktSEQZekJgy6JDVh0CWpCYMuSU0YdElqwqBLUhMGXZKaMOiS\n1IRBl6QmDLokNbFrkl+c5ALwXeAN4PWqWpjGoiRJGzdR0AfvrarXpvB9JEkT8JKLJDUxadALeCbJ\nqSRHp7EgSdLmTHrJ5faqupTkx4HFJC9W1XMrdxhCfxRg//79Ex5OkrSaic7Qq+rScLsEPAHceo19\njlfVQlUtzM3NTXI4SdL3semgJ7kuyVuv3AfeB5yZ1sIkSRszySWXvcATSa58n7+pqs9OZVWSpA3b\ndNCr6hvAzVNciyRpAv7YoiQ1YdAlqQmDLklNGHRJamIan+UiSVvi2OK5WS9hah44dNOWH8MzdElq\nwqBLUhMGXZKaMOiS1IRBl6QmDLokNWHQJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUhEGXpCYMuiQ1\nYdAlqQmDLklNGHRJasKgS1ITBl2SmjDoktSEQZekJgy6JDVh0CWpCYMuSU0YdElqwqBLUhMGXZKa\nMOiS1IRBl6QmDLokNWHQJamJiYKe5HCSl5J8PcmD01qUJGnjNh30JG8C/hx4P3AAuDfJgWktTJK0\nMZOcod8KfL2qvlFV/wn8LXDPdJYlSdqoSYL+duBbKx5fHLZJkmZg11YfIMlR4Ojw8N+SvLTJb7UH\neG06q5o5Z9l5uswBzrIj/fZks/zEenaaJOiXgBtWPH7HsO3/qKrjwPEJjgNAkpNVtTDp99kJnGXn\n6TIHOMtOtR2zTHLJ5Z+AG5O8M8kPAh8EnprOsiRJG7XpM/Sqej3JbwKfA94EPFJVz09tZZKkDZno\nGnpVPQ08PaW1rGXiyzY7iLPsPF3mAGfZqbZ8llTVVh9DkrQNfOu/JDUxiqCP+SMGkjySZCnJmRXb\nrk+ymOT8cLt7lmtcjyQ3JHk2yQtJnk9y/7B9jLP8UJIvJvnKMMsfDdtHNwssv2s7yZeTfGZ4PNY5\nLiT5WpLTSU4O28Y6y9uSfDLJi0nOJnn3dsyy44Pe4CMGHgUOX7XtQeBEVd0InBge73SvAx+pqgPA\nbcCHht+HMc7yH8CdVXUzcBA4nOQ2xjkLwP3A2RWPxzoHwHur6uCKH+8b6yx/Bny2qn4KuJnl35+t\nn6WqdvQX8G7gcysePwQ8NOt1bXCGeeDMiscvAfuG+/uAl2a9xk3M9CRwaOyzAD8CfAn4uTHOwvL7\nP04AdwKfGbaNbo5hrReAPVdtG90swI8C/8LwGuV2zrLjz9Dp+REDe6vq8nD/ZWDvLBezUUnmgVuA\nLzDSWYbLFKeBJWCxqsY6y58CvwN8b8W2Mc4BUMAzSU4N7zCHcc7yTuBV4K+GS2F/meQ6tmGWMQS9\ntVr+53o0P2qU5C3Ap4APV9V3Vj43plmq6o2qOsjyGe6tSX76qud3/CxJfhFYqqpTq+0zhjlWuH34\nPXk/y5f0fn7lkyOaZRfws8DHq+oW4N+56vLKVs0yhqCv6yMGRuaVJPsAhtulGa9nXZK8meWYf6Kq\nPj1sHuUsV1TVvwLPsvw6x9hmeQ/wS0kusPxpp3cm+WvGNwcAVXVpuF0CnmD5E13HOMtF4OLwvz6A\nT7Ic+C2fZQxB7/gRA08BR4b7R1i+Hr2jJQnwMHC2qj624qkxzjKX5G3D/R9m+bWAFxnZLFX1UFW9\no6rmWf578fmq+lVGNgdAkuuSvPXKfeB9wBlGOEtVvQx8K8m7hk13AS+wHbPM+gWEdb7IcDdwDvhn\n4PdmvZ4Nrv1x4DLwXyz/y30f8GMsv5B1HngGuH7W61zHHLez/F/ErwKnh6+7RzrLzwBfHmY5A/z+\nsH10s6yY6Q7+90XR0c0B/CTwleHr+St/z8c4y7Dug8DJ4c/Y3wO7t2MW3ykqSU2M4ZKLJGkdDLok\nNWHQJakJgy5JTRh0SWrCoEtSEwZdkpow6JLUxH8DH2w5+1M5nwUAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x119c5a2e8>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "bins = np.arange(0, 70,10)\n",
    "plt.hist(y_train, bins = bins, alpha = 0.5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "#輸出這邊我將資料分成群\n",
    "y_train[y_train<15] = 0\n",
    "y_train[(y_train>=15) & (y_train<25)] = 1\n",
    "y_train[(y_train>=25) & (y_train<35)] = 2\n",
    "y_train[(y_train>=35) & (y_train<45)] = 3\n",
    "y_train[(y_train>=45)] = 4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "y_test[y_test<15] = 0\n",
    "y_test[(y_test>=15) & (y_test<25)] = 1\n",
    "y_test[(y_test>=25) & (y_test<35)] = 2\n",
    "y_test[(y_test>=35) & (y_test<45)] = 3\n",
    "y_test[(y_test>=45)] = 4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    }
   ],
   "source": [
    "from keras.utils import np_utils\n",
    "y_train_trans = np_utils.to_categorical(y_train,5)\n",
    "y_test_trans = np_utils.to_categorical(y_test,5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "X = np.reshape(x_train,(90,15,1))\n",
    "X_test = np.reshape(x_test,(44,15,1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "#可以從這邊開始讀起\n",
    "np.savetxt('X.csv', X, delimiter=',')\n",
    "np.savetxt('X_test.csv', X_test, delimiter=',')\n",
    "np.savetxt('y_train_trans.csv', y_train_trans, delimiter=',')\n",
    "np.savetxt('y_test_trans.csv', y_test_trans, delimiter=',')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "X = np.loadtxt('X.csv', delimiter=',')\n",
    "X_test = np.loadtxt('X_test.csv', delimiter=',')\n",
    "y_train_trans = np.loadtxt('y_train_trans.csv', delimiter=',')\n",
    "y_test_trans = np.loadtxt('y_test_trans.csv', delimiter=',')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "X = np.reshape(X,(90,15,1))\n",
    "X_test = np.reshape(X_test,(44,15,1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "_________________________________________________________________\n",
      "Layer (type)                 Output Shape              Param #   \n",
      "=================================================================\n",
      "lstm_8 (LSTM)                (None, 256)               264192    \n",
      "_________________________________________________________________\n",
      "dropout_8 (Dropout)          (None, 256)               0         \n",
      "_________________________________________________________________\n",
      "dense_8 (Dense)              (None, 5)                 1285      \n",
      "=================================================================\n",
      "Total params: 265,477\n",
      "Trainable params: 265,477\n",
      "Non-trainable params: 0\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "from keras.models import Sequential\n",
    "from keras.layers import Dense,Activation, LSTM, Dropout\n",
    "from keras.optimizers import SGD\n",
    "model = Sequential()\n",
    "model.add(LSTM(256, activation=\"sigmoid\", input_shape=(X.shape[1], X.shape[2])))\n",
    "model.add(Dropout(0.2))\n",
    "model.add(Dense(y_train_trans.shape[1], activation='softmax'))\n",
    "model.compile(loss='categorical_crossentropy', optimizer='adam', metrics = [\"accuracy\"])\n",
    "model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train on 90 samples, validate on 44 samples\n",
      "Epoch 1/100\n",
      "90/90 [==============================] - 1s - loss: 1.6813 - acc: 0.2111 - val_loss: 1.6078 - val_acc: 0.0909\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 2/100\n",
      "90/90 [==============================] - 0s - loss: 1.6066 - acc: 0.2556 - val_loss: 1.5508 - val_acc: 0.1591\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 3/100\n",
      "90/90 [==============================] - 0s - loss: 1.5777 - acc: 0.2333 - val_loss: 1.5421 - val_acc: 0.1818\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 4/100\n",
      "90/90 [==============================] - 0s - loss: 1.5950 - acc: 0.2667 - val_loss: 1.5622 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 5/100\n",
      "90/90 [==============================] - 0s - loss: 1.5521 - acc: 0.2889 - val_loss: 1.5773 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 6/100\n",
      "90/90 [==============================] - 0s - loss: 1.5525 - acc: 0.2778 - val_loss: 1.5438 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 7/100\n",
      "90/90 [==============================] - 0s - loss: 1.5402 - acc: 0.2667 - val_loss: 1.5250 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 8/100\n",
      "90/90 [==============================] - 0s - loss: 1.5457 - acc: 0.2444 - val_loss: 1.5453 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 9/100\n",
      "90/90 [==============================] - 0s - loss: 1.5763 - acc: 0.2222 - val_loss: 1.5724 - val_acc: 0.1818\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 10/100\n",
      "90/90 [==============================] - 0s - loss: 1.5115 - acc: 0.2667 - val_loss: 1.5712 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 11/100\n",
      "90/90 [==============================] - 0s - loss: 1.4691 - acc: 0.3222 - val_loss: 1.5548 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 12/100\n",
      "90/90 [==============================] - 0s - loss: 1.5522 - acc: 0.2444 - val_loss: 1.5375 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 13/100\n",
      "90/90 [==============================] - 0s - loss: 1.4870 - acc: 0.3111 - val_loss: 1.5290 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 14/100\n",
      "90/90 [==============================] - 0s - loss: 1.5212 - acc: 0.2667 - val_loss: 1.5431 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 15/100\n",
      "90/90 [==============================] - 0s - loss: 1.4964 - acc: 0.3333 - val_loss: 1.5825 - val_acc: 0.2045\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 16/100\n",
      "90/90 [==============================] - 0s - loss: 1.4619 - acc: 0.3222 - val_loss: 1.5870 - val_acc: 0.1818\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 17/100\n",
      "90/90 [==============================] - 0s - loss: 1.4083 - acc: 0.2889 - val_loss: 1.5700 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 18/100\n",
      "90/90 [==============================] - 0s - loss: 1.5294 - acc: 0.2333 - val_loss: 1.5757 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 19/100\n",
      "90/90 [==============================] - 0s - loss: 1.4561 - acc: 0.3556 - val_loss: 1.5984 - val_acc: 0.1818\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 20/100\n",
      "90/90 [==============================] - 0s - loss: 1.4897 - acc: 0.2444 - val_loss: 1.5692 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 21/100\n",
      "90/90 [==============================] - 0s - loss: 1.4193 - acc: 0.4000 - val_loss: 1.5420 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 22/100\n",
      "90/90 [==============================] - 0s - loss: 1.4412 - acc: 0.3000 - val_loss: 1.5102 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 23/100\n",
      "90/90 [==============================] - 0s - loss: 1.4453 - acc: 0.2889 - val_loss: 1.5165 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 24/100\n",
      "90/90 [==============================] - 0s - loss: 1.4346 - acc: 0.2889 - val_loss: 1.5602 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 25/100\n",
      "90/90 [==============================] - 0s - loss: 1.4830 - acc: 0.2778 - val_loss: 1.5508 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 26/100\n",
      "90/90 [==============================] - 0s - loss: 1.4664 - acc: 0.2778 - val_loss: 1.5639 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 27/100\n",
      "90/90 [==============================] - 0s - loss: 1.4709 - acc: 0.2889 - val_loss: 1.5743 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 28/100\n",
      "90/90 [==============================] - 0s - loss: 1.4272 - acc: 0.3667 - val_loss: 1.6095 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 29/100\n",
      "90/90 [==============================] - 0s - loss: 1.4830 - acc: 0.2333 - val_loss: 1.6140 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 30/100\n",
      "90/90 [==============================] - 0s - loss: 1.4075 - acc: 0.3556 - val_loss: 1.5771 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 31/100\n",
      "90/90 [==============================] - 0s - loss: 1.4344 - acc: 0.3778 - val_loss: 1.5437 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 32/100\n",
      "90/90 [==============================] - 0s - loss: 1.4006 - acc: 0.3556 - val_loss: 1.5372 - val_acc: 0.3636\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 33/100\n",
      "90/90 [==============================] - 0s - loss: 1.4401 - acc: 0.3222 - val_loss: 1.5716 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 34/100\n",
      "90/90 [==============================] - 0s - loss: 1.4375 - acc: 0.3333 - val_loss: 1.6253 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 35/100\n",
      "90/90 [==============================] - 0s - loss: 1.3614 - acc: 0.3667 - val_loss: 1.6053 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 36/100\n",
      "90/90 [==============================] - 0s - loss: 1.4105 - acc: 0.3556 - val_loss: 1.6056 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 37/100\n",
      "90/90 [==============================] - 0s - loss: 1.4241 - acc: 0.3000 - val_loss: 1.5855 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 38/100\n",
      "90/90 [==============================] - 0s - loss: 1.4272 - acc: 0.3444 - val_loss: 1.5815 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 39/100\n",
      "90/90 [==============================] - 0s - loss: 1.4055 - acc: 0.3333 - val_loss: 1.5967 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 40/100\n",
      "90/90 [==============================] - 0s - loss: 1.3645 - acc: 0.3667 - val_loss: 1.6088 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 41/100\n",
      "90/90 [==============================] - 0s - loss: 1.4160 - acc: 0.2667 - val_loss: 1.5991 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 42/100\n",
      "90/90 [==============================] - 0s - loss: 1.4032 - acc: 0.3333 - val_loss: 1.5964 - val_acc: 0.3636\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 43/100\n",
      "90/90 [==============================] - 0s - loss: 1.4390 - acc: 0.3444 - val_loss: 1.6330 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 44/100\n",
      "90/90 [==============================] - 0s - loss: 1.3423 - acc: 0.4444 - val_loss: 1.6600 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 45/100\n",
      "90/90 [==============================] - 0s - loss: 1.3658 - acc: 0.3889 - val_loss: 1.6470 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 46/100\n",
      "90/90 [==============================] - 0s - loss: 1.3440 - acc: 0.4333 - val_loss: 1.6246 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 47/100\n",
      "90/90 [==============================] - 0s - loss: 1.3752 - acc: 0.4111 - val_loss: 1.6027 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 48/100\n",
      "90/90 [==============================] - 0s - loss: 1.4116 - acc: 0.3444 - val_loss: 1.6307 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 49/100\n",
      "90/90 [==============================] - 0s - loss: 1.3516 - acc: 0.3667 - val_loss: 1.6544 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 50/100\n",
      "90/90 [==============================] - 0s - loss: 1.3665 - acc: 0.3222 - val_loss: 1.6850 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 51/100\n",
      "90/90 [==============================] - 0s - loss: 1.3315 - acc: 0.4000 - val_loss: 1.6841 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 52/100\n",
      "90/90 [==============================] - 0s - loss: 1.3814 - acc: 0.3444 - val_loss: 1.6537 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 53/100\n",
      "90/90 [==============================] - 0s - loss: 1.3513 - acc: 0.4111 - val_loss: 1.6439 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 54/100\n",
      "90/90 [==============================] - 0s - loss: 1.3161 - acc: 0.3889 - val_loss: 1.6461 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 55/100\n",
      "90/90 [==============================] - 0s - loss: 1.3512 - acc: 0.3222 - val_loss: 1.6840 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 56/100\n",
      "90/90 [==============================] - 0s - loss: 1.3645 - acc: 0.3778 - val_loss: 1.7223 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 57/100\n",
      "90/90 [==============================] - 0s - loss: 1.3283 - acc: 0.4000 - val_loss: 1.7128 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 58/100\n",
      "90/90 [==============================] - 0s - loss: 1.3420 - acc: 0.3667 - val_loss: 1.6953 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 59/100\n",
      "90/90 [==============================] - 0s - loss: 1.3458 - acc: 0.3444 - val_loss: 1.6780 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 60/100\n",
      "90/90 [==============================] - 0s - loss: 1.3449 - acc: 0.3889 - val_loss: 1.6954 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 61/100\n",
      "90/90 [==============================] - 0s - loss: 1.3119 - acc: 0.4222 - val_loss: 1.6795 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 62/100\n",
      "90/90 [==============================] - 0s - loss: 1.3495 - acc: 0.3333 - val_loss: 1.6916 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 63/100\n",
      "90/90 [==============================] - 0s - loss: 1.3640 - acc: 0.3222 - val_loss: 1.6999 - val_acc: 0.3409\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 64/100\n",
      "90/90 [==============================] - 0s - loss: 1.3297 - acc: 0.4333 - val_loss: 1.7527 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 65/100\n",
      "90/90 [==============================] - 0s - loss: 1.3168 - acc: 0.3556 - val_loss: 1.7600 - val_acc: 0.3182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 66/100\n",
      "90/90 [==============================] - 0s - loss: 1.3092 - acc: 0.3222 - val_loss: 1.7310 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 67/100\n",
      "90/90 [==============================] - 0s - loss: 1.2786 - acc: 0.4889 - val_loss: 1.7083 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 68/100\n",
      "90/90 [==============================] - 0s - loss: 1.3251 - acc: 0.3778 - val_loss: 1.7584 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 69/100\n",
      "90/90 [==============================] - 0s - loss: 1.2959 - acc: 0.3444 - val_loss: 1.7974 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 70/100\n",
      "90/90 [==============================] - 0s - loss: 1.2958 - acc: 0.4111 - val_loss: 1.7951 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 71/100\n",
      "90/90 [==============================] - 0s - loss: 1.2659 - acc: 0.3778 - val_loss: 1.7791 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 72/100\n",
      "90/90 [==============================] - 0s - loss: 1.3010 - acc: 0.4111 - val_loss: 1.7776 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 73/100\n",
      "90/90 [==============================] - 0s - loss: 1.2804 - acc: 0.3778 - val_loss: 1.7707 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 74/100\n",
      "90/90 [==============================] - 0s - loss: 1.2430 - acc: 0.4889 - val_loss: 1.7807 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 75/100\n",
      "90/90 [==============================] - 0s - loss: 1.2818 - acc: 0.3889 - val_loss: 1.7776 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 76/100\n",
      "90/90 [==============================] - 0s - loss: 1.2900 - acc: 0.3778 - val_loss: 1.7938 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 77/100\n",
      "90/90 [==============================] - 0s - loss: 1.2698 - acc: 0.4111 - val_loss: 1.8267 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 78/100\n",
      "90/90 [==============================] - 0s - loss: 1.2451 - acc: 0.4556 - val_loss: 1.8175 - val_acc: 0.2955\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 79/100\n",
      "90/90 [==============================] - 0s - loss: 1.2426 - acc: 0.4333 - val_loss: 1.8123 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 80/100\n",
      "90/90 [==============================] - 0s - loss: 1.2854 - acc: 0.3778 - val_loss: 1.8086 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 81/100\n",
      "90/90 [==============================] - 0s - loss: 1.2942 - acc: 0.3222 - val_loss: 1.7999 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 82/100\n",
      "90/90 [==============================] - 0s - loss: 1.2641 - acc: 0.4111 - val_loss: 1.8569 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 83/100\n",
      "90/90 [==============================] - 0s - loss: 1.2719 - acc: 0.4000 - val_loss: 1.8987 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 84/100\n",
      "90/90 [==============================] - 0s - loss: 1.2902 - acc: 0.4000 - val_loss: 1.9009 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 85/100\n",
      "90/90 [==============================] - 0s - loss: 1.2864 - acc: 0.3667 - val_loss: 1.8506 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 86/100\n",
      "90/90 [==============================] - 0s - loss: 1.2757 - acc: 0.4111 - val_loss: 1.8538 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 87/100\n",
      "90/90 [==============================] - 0s - loss: 1.2256 - acc: 0.4667 - val_loss: 1.8585 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 88/100\n",
      "90/90 [==============================] - 0s - loss: 1.2360 - acc: 0.4333 - val_loss: 1.9173 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 89/100\n",
      "90/90 [==============================] - 0s - loss: 1.1998 - acc: 0.5000 - val_loss: 1.9397 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 90/100\n",
      "90/90 [==============================] - 0s - loss: 1.2406 - acc: 0.4111 - val_loss: 1.9220 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 91/100\n",
      "90/90 [==============================] - 0s - loss: 1.2271 - acc: 0.4000 - val_loss: 1.9214 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 92/100\n",
      "90/90 [==============================] - 0s - loss: 1.2560 - acc: 0.4000 - val_loss: 1.8997 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 93/100\n",
      "90/90 [==============================] - 0s - loss: 1.2440 - acc: 0.4111 - val_loss: 1.9291 - val_acc: 0.2727\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 94/100\n",
      "90/90 [==============================] - 0s - loss: 1.2688 - acc: 0.4000 - val_loss: 1.9828 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 95/100\n",
      "90/90 [==============================] - 0s - loss: 1.2307 - acc: 0.5222 - val_loss: 1.9426 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 96/100\n",
      "90/90 [==============================] - 0s - loss: 1.2496 - acc: 0.4222 - val_loss: 1.9290 - val_acc: 0.2273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 97/100\n",
      "90/90 [==============================] - 0s - loss: 1.2141 - acc: 0.4667 - val_loss: 1.9557 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 98/100\n",
      "90/90 [==============================] - 0s - loss: 1.1743 - acc: 0.5000 - val_loss: 1.9462 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 99/100\n",
      "90/90 [==============================] - 0s - loss: 1.2455 - acc: 0.4333 - val_loss: 1.9394 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n",
      "Epoch 100/100\n",
      "90/90 [==============================] - 0s - loss: 1.2093 - acc: 0.4778 - val_loss: 1.9793 - val_acc: 0.2500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<keras.callbacks.History at 0x12f994dd8>"
      ]
     },
     "execution_count": 161,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(X,y_train_trans,batch_size=30, epochs=100, validation_data=(X_test, y_test_trans))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "score = model.evaluate(X_test, y_test_trans, verbose=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Error when checking : expected lstm_7_input to have 3 dimensions, but got array with shape (44, 15)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-148-8a7b6bcf799e>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m/Users/jason/anaconda/lib/python3.6/site-packages/keras/models.py\u001b[0m in \u001b[0;36mpredict\u001b[0;34m(self, x, batch_size, verbose)\u001b[0m\n\u001b[1;32m    897\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodel\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    898\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbuild\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 899\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbatch_size\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbatch_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mverbose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mverbose\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    900\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    901\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mpredict_on_batch\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/Users/jason/anaconda/lib/python3.6/site-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mpredict\u001b[0;34m(self, x, batch_size, verbose)\u001b[0m\n\u001b[1;32m   1553\u001b[0m         x = _standardize_input_data(x, self._feed_input_names,\n\u001b[1;32m   1554\u001b[0m                                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_feed_input_shapes\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1555\u001b[0;31m                                     check_batch_axis=False)\n\u001b[0m\u001b[1;32m   1556\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstateful\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1557\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0mbatch_size\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0mbatch_size\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/Users/jason/anaconda/lib/python3.6/site-packages/keras/engine/training.py\u001b[0m in \u001b[0;36m_standardize_input_data\u001b[0;34m(data, names, shapes, check_batch_axis, exception_prefix)\u001b[0m\n\u001b[1;32m    119\u001b[0m                                  \u001b[0;34m' to have '\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mshapes\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m+\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    120\u001b[0m                                  \u001b[0;34m' dimensions, but got array with shape '\u001b[0m \u001b[0;34m+\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 121\u001b[0;31m                                  str(array.shape))\n\u001b[0m\u001b[1;32m    122\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0mj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mdim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mref_dim\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32min\u001b[0m \u001b[0menumerate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mzip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mshapes\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    123\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mj\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mcheck_batch_axis\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: Error when checking : expected lstm_7_input to have 3 dimensions, but got array with shape (44, 15)"
     ]
    }
   ],
   "source": [
    "result = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<function __main__.identify>"
      ]
     },
     "execution_count": 149,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from ipywidgets import interact_manual\n",
    "def identify(testnumber):\n",
    "    print(\"神經網路判斷為：\",result[testnumber])\n",
    "    print(\"正確答案是:\",y_test_trans[testnumber])\n",
    "interact_manual(identify, testnumber=(0,44))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.0"
  },
  "widgets": {
   "state": {
    "d201d8231ba04f92b89d2e2fb1e20200": {
     "views": [
      {
       "cell_index": 53
      }
     ]
    }
   },
   "version": "1.2.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
